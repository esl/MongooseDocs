
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>MUC light - MongooseIM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../css/version-select.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="MongooseIM" class="md-header-nav__button md-logo" aria-label="MongooseIM">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            MongooseIM
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              MUC light
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MongooseIM" class="md-nav__button md-logo" aria-label="MongooseIM">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    MongooseIM
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      User guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="User guide" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        User guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/ABCs-of-MongooseIM/" class="md-nav__link">
      ABCs of MongooseIM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/MongooseIM-High-level-Architecture/" class="md-nav__link">
      High-level Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/Features-and-supported-standards/" class="md-nav__link">
      Features and supported standards
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/Getting-started/" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/release_config/" class="md-nav__link">
      Release/Installation configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/Bootstrap-Scripts/" class="md-nav__link">
      Bootstrap scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/client-certificate/" class="md-nav__link">
      Client certificate authentication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Tutorials
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/How-to-build/" class="md-nav__link">
      How to Build MongooseIM from source code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/push-notifications/Push-notifications/" class="md-nav__link">
      How to Set up Push Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/push-notifications/Push-notifications-client-side/" class="md-nav__link">
      How to Set up Push Notifications on the client side
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/push-notifications/MongoosePush-setup/" class="md-nav__link">
      How to Set up MongoosePush
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/ICE_tutorial/" class="md-nav__link">
      How to Set up MongooseICE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/iOS_tutorial/" class="md-nav__link">
      How to Build an iOS messaging app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../user-guide/Jingle-SIP-setup/" class="md-nav__link">
      How to Set up Jingle/SIP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Migration Guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Migration Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Migration Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/3.1.1_3.2.0/" class="md-nav__link">
      3.1.1 to 3.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/3.3.0_3.4.0/" class="md-nav__link">
      3.3.0 to 3.4.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/3.5.0_3.6.0/" class="md-nav__link">
      3.5.0 to 3.6.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/3.6.0_3.7.0/" class="md-nav__link">
      3.6.0 to 3.7.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/3.7.0_4.0.0/" class="md-nav__link">
      3.7.0 to 4.0.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/4.0.0_4.0.1/" class="md-nav__link">
      4.0.0 to 4.0.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../migrations/jid-from-mam-muc-script/" class="md-nav__link">
      MAM MUC migration helper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    <label class="md-nav__link" for="nav-5">
      Platform
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Platform" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Platform
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Contributions/" class="md-nav__link">
      Contributions to ecosystem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Differentiators/" class="md-nav__link">
      Differentiators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../History/" class="md-nav__link">
      History
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
    <label class="md-nav__link" for="nav-6">
      Configuration
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Configuration" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/configuration-files/" class="md-nav__link">
      Configuration files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/general/" class="md-nav__link">
      Options: General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/listen/" class="md-nav__link">
      Options: Listen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/auth/" class="md-nav__link">
      Options: Auth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/outgoing-connections/" class="md-nav__link">
      Options: Outgoing connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/Services/" class="md-nav__link">
      Options: Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/Modules/" class="md-nav__link">
      Options: Extension Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/shaper/" class="md-nav__link">
      Options: Shaper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/acl/" class="md-nav__link">
      Options: Acl
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/access/" class="md-nav__link">
      Options: Access
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/s2s/" class="md-nav__link">
      Options: S2S
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/host_config/" class="md-nav__link">
      Options: Host config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/release-options/" class="md-nav__link">
      Release options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/Erlang-cookie-security/" class="md-nav__link">
      Erlang Cookie Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/TLS-hardening/" class="md-nav__link">
      TLS hardening
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-configuration/database-backends-configuration/" class="md-nav__link">
      Database backends configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    <label class="md-nav__link" for="nav-7">
      Authentication methods
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Authentication methods" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Authentication methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/rdbms/" class="md-nav__link">
      RDBMS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/external/" class="md-nav__link">
      External
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/anonymous/" class="md-nav__link">
      Anonymous
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/ldap/" class="md-nav__link">
      LDAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/jwt/" class="md-nav__link">
      JWT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/riak/" class="md-nav__link">
      Riak
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/http/" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/pki/" class="md-nav__link">
      PKI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../authentication-methods/dummy/" class="md-nav__link">
      Dummy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    <label class="md-nav__link" for="nav-8">
      MongooseIM open XMPP extensions
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="MongooseIM open XMPP extensions" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        MongooseIM open XMPP extensions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        MUC light
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      MUC light
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-requirements" class="md-nav__link">
    2. Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-entity-use-cases" class="md-nav__link">
    3. Entity Use Cases
  </a>
  
    <nav class="md-nav" aria-label="3. Entity Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-discovering-a-muc-light-service" class="md-nav__link">
    3.1. Discovering a MUC Light Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-discovering-the-features-supported-by-a-muc-light-service" class="md-nav__link">
    3.2. Discovering the Features Supported by a MUC Light Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-discovering-occupied-rooms" class="md-nav__link">
    3.3. Discovering Occupied Rooms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-occupant-use-cases" class="md-nav__link">
    4. Occupant Use Cases
  </a>
  
    <nav class="md-nav" aria-label="4. Occupant Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-sending-a-message-to-a-room" class="md-nav__link">
    4.1. Sending a message to a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-changing-a-room-subject" class="md-nav__link">
    4.2. Changing a room subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-requesting-room-information" class="md-nav__link">
    4.3. Requesting room information
  </a>
  
    <nav class="md-nav" aria-label="4.3. Requesting room information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-getting-the-room-configuration" class="md-nav__link">
    4.3.1. Getting the room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-requesting-a-user-list" class="md-nav__link">
    4.3.2. Requesting a user list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-requesting-full-room-information" class="md-nav__link">
    4.3.3. Requesting full room information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-leaving-the-room" class="md-nav__link">
    4.4. Leaving the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-blocking-functionality" class="md-nav__link">
    4.5. Blocking functionality
  </a>
  
    <nav class="md-nav" aria-label="4.5. Blocking functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451-requesting-a-blocking-list" class="md-nav__link">
    4.5.1. Requesting a blocking list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#452-blocking-a-room" class="md-nav__link">
    4.5.2. Blocking a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#453-blocking-a-user" class="md-nav__link">
    4.5.3. Blocking a user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#454-unblocking" class="md-nav__link">
    4.5.4. Unblocking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-owner-use-cases" class="md-nav__link">
    5. Owner Use Cases
  </a>
  
    <nav class="md-nav" aria-label="5. Owner Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-a-new-room" class="md-nav__link">
    5.1. Creating a new room
  </a>
  
    <nav class="md-nav" aria-label="5.1. Creating a new room">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-requesting-a-new-room-with-a-unique-name" class="md-nav__link">
    5.1.1. Requesting a new room with a unique name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-room-already-exists" class="md-nav__link">
    5.1.2. Room already exists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-destroying-a-room" class="md-nav__link">
    5.2. Destroying a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-setting-room-configuration" class="md-nav__link">
    5.3. Setting room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-changing-the-occupant-list" class="md-nav__link">
    5.4. Changing the occupant list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-interactions-with-rfcs-and-other-xeps" class="md-nav__link">
    6. Interactions with RFCs and other XEPs
  </a>
  
    <nav class="md-nav" aria-label="6. Interactions with RFCs and other XEPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-user-rosters" class="md-nav__link">
    6.1. User rosters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-xep-0313-message-archive-management" class="md-nav__link">
    6.2. XEP-0313 Message Archive Management
  </a>
  
    <nav class="md-nav" aria-label="6.2. XEP-0313 Message Archive Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-groupchat-message-from-occupant" class="md-nav__link">
    6.2.1. Groupchat message from occupant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-affiliation-change" class="md-nav__link">
    6.2.2. Affiliation change
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-room-creation" class="md-nav__link">
    6.2.3. Room creation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-general-error-cases" class="md-nav__link">
    7. General Error Cases
  </a>
  
    <nav class="md-nav" aria-label="7. General Error Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-client-sends-an-unauthorized-stanza-to-a-room" class="md-nav__link">
    7.1. Client sends an unauthorized stanza to a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-client-sends-a-presence-stanza-to-the-service" class="md-nav__link">
    7.2. Client sends a &lt;presence/&gt; stanza to the service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-client-sends-an-invalid-stanza-to-the-service" class="md-nav__link">
    7.3. Client sends an invalid stanza to the service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-request-sender-has-insufficient-privileges" class="md-nav__link">
    7.4. Request sender has insufficient privileges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-implementation-notes" class="md-nav__link">
    8. Implementation Notes
  </a>
  
    <nav class="md-nav" aria-label="8. Implementation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-xep-0045-mappings" class="md-nav__link">
    8.1. XEP-0045 mappings
  </a>
  
    <nav class="md-nav" aria-label="8.1. XEP-0045 mappings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#811-discovering-the-features-supported-by-a-muc-service" class="md-nav__link">
    8.1.1. Discovering the Features Supported by a MUC Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#812-discovering-occupied-rooms" class="md-nav__link">
    8.1.2. Discovering Occupied Rooms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#813-changing-a-room-subject" class="md-nav__link">
    8.1.3. Changing a room subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#814-getting-a-room-configuration" class="md-nav__link">
    8.1.4. Getting a room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#815-requesting-a-user-list" class="md-nav__link">
    8.1.5. Requesting a user list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#816-requesting-room-information" class="md-nav__link">
    8.1.6. Requesting room information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#817-leaving-the-room" class="md-nav__link">
    8.1.7. Leaving the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#818-blocking-functionality" class="md-nav__link">
    8.1.8. Blocking functionality
  </a>
  
    <nav class="md-nav" aria-label="8.1.8. Blocking functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8181-request-blocking-list" class="md-nav__link">
    8.1.8.1. Request blocking list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8182-blocking-a-room" class="md-nav__link">
    8.1.8.2. Blocking a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8183-blocking-a-user" class="md-nav__link">
    8.1.8.3. Blocking a user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8184-unblocking" class="md-nav__link">
    8.1.8.4. Unblocking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#819-creating-a-room" class="md-nav__link">
    8.1.9. Creating a room
  </a>
  
    <nav class="md-nav" aria-label="8.1.9. Creating a room">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8191-room-already-exists" class="md-nav__link">
    8.1.9.1. Room already exists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8110-destroying-the-room" class="md-nav__link">
    8.1.10. Destroying the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8111-setting-room-configuration" class="md-nav__link">
    8.1.11. Setting room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8112-changing-occupant-list" class="md-nav__link">
    8.1.12. Changing occupant list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-service-limits-and-configuration" class="md-nav__link">
    8.2. Service limits and configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../token-reconnection/" class="md-nav__link">
      Token-based reconnection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" >
    <label class="md-nav__link" for="nav-9">
      REST API
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="REST API" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        REST API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../rest-api/Client-frontend/" class="md-nav__link">
      Client/frontend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rest-api/Metrics-backend/" class="md-nav__link">
      Metrics backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../rest-api/Administration-backend/" class="md-nav__link">
      Administration backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" >
    <label class="md-nav__link" for="nav-10">
      Operation and maintenance
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Operation and maintenance" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        Operation and maintenance
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/gdpr-considerations/" class="md-nav__link">
      GDPR considerations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Cluster-management-considerations/" class="md-nav__link">
      Cluster management considerations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Cluster-configuration-and-node-management/" class="md-nav__link">
      Cluster configuration and node management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Logging-%26-monitoring/" class="md-nav__link">
      Logging & monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Logging/" class="md-nav__link">
      Logging configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Humio/" class="md-nav__link">
      Logging with Humio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Logging-fields/" class="md-nav__link">
      Logging fields
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/Reloading-configuration-on-a-running-system/" class="md-nav__link">
      Reloading configuration on a running system
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/MongooseIM-metrics/" class="md-nav__link">
      Metrics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/System-Metrics-Privacy-Policy/" class="md-nav__link">
      System Metrics Privacy Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/tls-distribution/" class="md-nav__link">
      Distribution over TLS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../operation-and-maintenance/known-issues/" class="md-nav__link">
      Known issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11" >
    <label class="md-nav__link" for="nav-11">
      Developer's guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Developer's guide" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        Developer's guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/Testing-MongooseIM/" class="md-nav__link">
      Testing MongooseIM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/logging/" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/Hooks-and-handlers/" class="md-nav__link">
      Hooks and Handlers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/hooks_description/" class="md-nav__link">
      Hooks description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/Stanza-routing/" class="md-nav__link">
      Stanza routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/accumulators/" class="md-nav__link">
      Accumulators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/flat_options/" class="md-nav__link">
      Flat options format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/Moving-to-single-app-project-structure/" class="md-nav__link">
      Moving to single app project structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/mod_amp_developers_guide/" class="md-nav__link">
      mod_amp development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/mod_muc_light_developers_guide/" class="md-nav__link">
      mod_muc_light developers doc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/SCRAM-serialization/" class="md-nav__link">
      SCRAM serialization format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/xep_tool/" class="md-nav__link">
      xep-tool usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/OpenSSL-and-FIPS/" class="md-nav__link">
      FIPS mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/Basic-iq-handler/" class="md-nav__link">
      Basic IQ Handler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../developers-guide/mongoose_wpool/" class="md-nav__link">
      mongoose_wpool
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12" >
    <label class="md-nav__link" for="nav-12">
      Module index
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Module index" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon"></span>
        Module index
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_adhoc/" class="md-nav__link">
      mod_adhoc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_amp/" class="md-nav__link">
      mod_amp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_auth_token/" class="md-nav__link">
      mod_auth_token
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_blocking/" class="md-nav__link">
      mod_blocking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_bosh/" class="md-nav__link">
      mod_bosh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_caps/" class="md-nav__link">
      mod_caps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_carboncopy/" class="md-nav__link">
      mod_carboncopy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_commands/" class="md-nav__link">
      mod_commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_csi/" class="md-nav__link">
      mod_csi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_disco/" class="md-nav__link">
      mod_disco
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12-11" type="checkbox" id="nav-12-11" >
    <label class="md-nav__link" for="nav-12-11">
      mod_event_pusher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="mod_event_pusher" data-md-level="2">
      <label class="md-nav__title" for="nav-12-11">
        <span class="md-nav__icon md-icon"></span>
        mod_event_pusher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_event_pusher/" class="md-nav__link">
      mod_event_pusher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_event_pusher_http/" class="md-nav__link">
      HTTP backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_event_pusher_push/" class="md-nav__link">
      Push backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_event_pusher_sns/" class="md-nav__link">
      SNS backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_event_pusher_rabbit/" class="md-nav__link">
      RabbitMQ backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_extdisco/" class="md-nav__link">
      mod_extdisco
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_global_distrib/" class="md-nav__link">
      mod_global_distrib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_http_upload/" class="md-nav__link">
      mod_http_upload
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_inbox/" class="md-nav__link">
      mod_inbox
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_jingle_sip/" class="md-nav__link">
      mod_jingle_sip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_keystore/" class="md-nav__link">
      mod_keystore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_last/" class="md-nav__link">
      mod_last
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_mam/" class="md-nav__link">
      mod_mam
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_muc/" class="md-nav__link">
      mod_muc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_muc_commands/" class="md-nav__link">
      mod_muc_commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_muc_log/" class="md-nav__link">
      mod_muc_log
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_muc_light/" class="md-nav__link">
      mod_muc_light
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_muc_light_commands/" class="md-nav__link">
      mod_muc_light_commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_offline/" class="md-nav__link">
      mod_offline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_offline_stub/" class="md-nav__link">
      mod_offline_stub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_ping/" class="md-nav__link">
      mod_ping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_privacy/" class="md-nav__link">
      mod_privacy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_private/" class="md-nav__link">
      mod_private
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_pubsub/" class="md-nav__link">
      mod_pubsub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_push_service_mongoosepush/" class="md-nav__link">
      mod_push_service_mongoosepush
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_register/" class="md-nav__link">
      mod_register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_roster/" class="md-nav__link">
      mod_roster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_shared_roster_ldap/" class="md-nav__link">
      mod_shared_roster_ldap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_sic/" class="md-nav__link">
      mod_sic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_stream_management/" class="md-nav__link">
      mod_stream_management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_time/" class="md-nav__link">
      mod_time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_vcard/" class="md-nav__link">
      mod_vcard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../modules/mod_version/" class="md-nav__link">
      mod_version
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    1. Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-requirements" class="md-nav__link">
    2. Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-entity-use-cases" class="md-nav__link">
    3. Entity Use Cases
  </a>
  
    <nav class="md-nav" aria-label="3. Entity Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-discovering-a-muc-light-service" class="md-nav__link">
    3.1. Discovering a MUC Light Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-discovering-the-features-supported-by-a-muc-light-service" class="md-nav__link">
    3.2. Discovering the Features Supported by a MUC Light Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-discovering-occupied-rooms" class="md-nav__link">
    3.3. Discovering Occupied Rooms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-occupant-use-cases" class="md-nav__link">
    4. Occupant Use Cases
  </a>
  
    <nav class="md-nav" aria-label="4. Occupant Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-sending-a-message-to-a-room" class="md-nav__link">
    4.1. Sending a message to a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-changing-a-room-subject" class="md-nav__link">
    4.2. Changing a room subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-requesting-room-information" class="md-nav__link">
    4.3. Requesting room information
  </a>
  
    <nav class="md-nav" aria-label="4.3. Requesting room information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#431-getting-the-room-configuration" class="md-nav__link">
    4.3.1. Getting the room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-requesting-a-user-list" class="md-nav__link">
    4.3.2. Requesting a user list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-requesting-full-room-information" class="md-nav__link">
    4.3.3. Requesting full room information
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-leaving-the-room" class="md-nav__link">
    4.4. Leaving the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-blocking-functionality" class="md-nav__link">
    4.5. Blocking functionality
  </a>
  
    <nav class="md-nav" aria-label="4.5. Blocking functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451-requesting-a-blocking-list" class="md-nav__link">
    4.5.1. Requesting a blocking list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#452-blocking-a-room" class="md-nav__link">
    4.5.2. Blocking a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#453-blocking-a-user" class="md-nav__link">
    4.5.3. Blocking a user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#454-unblocking" class="md-nav__link">
    4.5.4. Unblocking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-owner-use-cases" class="md-nav__link">
    5. Owner Use Cases
  </a>
  
    <nav class="md-nav" aria-label="5. Owner Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-creating-a-new-room" class="md-nav__link">
    5.1. Creating a new room
  </a>
  
    <nav class="md-nav" aria-label="5.1. Creating a new room">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-requesting-a-new-room-with-a-unique-name" class="md-nav__link">
    5.1.1. Requesting a new room with a unique name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#512-room-already-exists" class="md-nav__link">
    5.1.2. Room already exists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-destroying-a-room" class="md-nav__link">
    5.2. Destroying a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-setting-room-configuration" class="md-nav__link">
    5.3. Setting room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-changing-the-occupant-list" class="md-nav__link">
    5.4. Changing the occupant list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-interactions-with-rfcs-and-other-xeps" class="md-nav__link">
    6. Interactions with RFCs and other XEPs
  </a>
  
    <nav class="md-nav" aria-label="6. Interactions with RFCs and other XEPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-user-rosters" class="md-nav__link">
    6.1. User rosters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-xep-0313-message-archive-management" class="md-nav__link">
    6.2. XEP-0313 Message Archive Management
  </a>
  
    <nav class="md-nav" aria-label="6.2. XEP-0313 Message Archive Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621-groupchat-message-from-occupant" class="md-nav__link">
    6.2.1. Groupchat message from occupant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622-affiliation-change" class="md-nav__link">
    6.2.2. Affiliation change
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623-room-creation" class="md-nav__link">
    6.2.3. Room creation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-general-error-cases" class="md-nav__link">
    7. General Error Cases
  </a>
  
    <nav class="md-nav" aria-label="7. General Error Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-client-sends-an-unauthorized-stanza-to-a-room" class="md-nav__link">
    7.1. Client sends an unauthorized stanza to a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-client-sends-a-presence-stanza-to-the-service" class="md-nav__link">
    7.2. Client sends a &lt;presence/&gt; stanza to the service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-client-sends-an-invalid-stanza-to-the-service" class="md-nav__link">
    7.3. Client sends an invalid stanza to the service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-request-sender-has-insufficient-privileges" class="md-nav__link">
    7.4. Request sender has insufficient privileges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-implementation-notes" class="md-nav__link">
    8. Implementation Notes
  </a>
  
    <nav class="md-nav" aria-label="8. Implementation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-xep-0045-mappings" class="md-nav__link">
    8.1. XEP-0045 mappings
  </a>
  
    <nav class="md-nav" aria-label="8.1. XEP-0045 mappings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#811-discovering-the-features-supported-by-a-muc-service" class="md-nav__link">
    8.1.1. Discovering the Features Supported by a MUC Service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#812-discovering-occupied-rooms" class="md-nav__link">
    8.1.2. Discovering Occupied Rooms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#813-changing-a-room-subject" class="md-nav__link">
    8.1.3. Changing a room subject
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#814-getting-a-room-configuration" class="md-nav__link">
    8.1.4. Getting a room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#815-requesting-a-user-list" class="md-nav__link">
    8.1.5. Requesting a user list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#816-requesting-room-information" class="md-nav__link">
    8.1.6. Requesting room information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#817-leaving-the-room" class="md-nav__link">
    8.1.7. Leaving the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#818-blocking-functionality" class="md-nav__link">
    8.1.8. Blocking functionality
  </a>
  
    <nav class="md-nav" aria-label="8.1.8. Blocking functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8181-request-blocking-list" class="md-nav__link">
    8.1.8.1. Request blocking list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8182-blocking-a-room" class="md-nav__link">
    8.1.8.2. Blocking a room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8183-blocking-a-user" class="md-nav__link">
    8.1.8.3. Blocking a user
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8184-unblocking" class="md-nav__link">
    8.1.8.4. Unblocking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#819-creating-a-room" class="md-nav__link">
    8.1.9. Creating a room
  </a>
  
    <nav class="md-nav" aria-label="8.1.9. Creating a room">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8191-room-already-exists" class="md-nav__link">
    8.1.9.1. Room already exists
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8110-destroying-the-room" class="md-nav__link">
    8.1.10. Destroying the room
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8111-setting-room-configuration" class="md-nav__link">
    8.1.11. Setting room configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8112-changing-occupant-list" class="md-nav__link">
    8.1.12. Changing occupant list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-service-limits-and-configuration" class="md-nav__link">
    8.2. Service limits and configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>MUC light</h1>
                
                <h2 id="1-introduction">1. Introduction</h2>
<p>Classic Multi-User chat, as described in XEP-0045, adds an IRC-like functionality to XMPP. 
It distinguishes between the affiliation list and the occupant list, where the latter is based on presences routed to the room from the client resource. 
While perfectly sufficient for desktop applications and relatively stable network connection, it does not exactly meet the challenges the mobile world it is facing. 
Modern mobile applications do not rely on presence information, as it can frequently change. The expected user experience not only differs from the IRC model, but also uses only a small subset of XEP-0045 features. 
The service described in this specification attempts to provide a complete solution for all common use cases of mobile groupchats.</p>
<h2 id="2-requirements">2. Requirements</h2>
<p>Here are some high-level features required from a new variant of MUC</p>
<ol>
<li>The service allows any user to create a room for group communication.</li>
<li>Users cannot join rooms on their own. They have to be added by the room owner or (if configured by service administrator) any other occupant.</li>
<li>Only the owner can remove other occupants from the room.</li>
<li>Every occupant can leave the room.</li>
<li>A user may block the attempts of being added to the specific room or by specific user.</li>
<li>The message sent in the room is always broadcasted to every occupant.</li>
<li>The full occupant list is always available to all occupants.</li>
<li>The occupant is always visible on the list, even if they do not have any resources online.</li>
<li>Occupants can only have two affiliations: owner and member.</li>
<li>There MUST be at most one owner in the room (the service can choose to treat all users equally).</li>
<li>If the room becomes empty, it is destroyed.</li>
<li>Occupants cannot hide behind nicks. Their real bare JID is always visible to everyone</li>
<li>No exchange of any <code>&lt;presence/&gt;</code> stanza inside the room.</li>
<li>The user MUST be able to retrieve the list of rooms they occupy.</li>
<li>The owner can modify the room configuration at any time; members may also be allowed to set configuration.</li>
<li>All occupants can get the full room configuration at any time.</li>
<li>Room history is available only in Message Archive Management.</li>
</ol>
<h2 id="3-entity-use-cases">3. Entity Use Cases</h2>
<h3 id="31-discovering-a-muc-light-service">3.1. Discovering a MUC Light Service</h3>
<p>An entity often discovers a MUC service by sending a Service Discovery items ("disco#items") request to its own server.</p>
<p><strong>Entity Queries the Server for Associated Services</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;h7ns81g&#39;</span>
    <span class="na">to=</span><span class="s">&#39;shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p>The server then returns the services that are associated with it.</p>
<p><strong>Server Returns a Disco Items Result</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;h7ns81g&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;MUC Light Service&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="32-discovering-the-features-supported-by-a-muc-light-service">3.2. Discovering the Features Supported by a MUC Light Service</h3>
<p>An entity may wish to discover if a service implements the Multi-User Chat protocol; in order to do so, it sends a service discovery information ("disco#info") query to the MUC service's JID.</p>
<p><strong>Entity Queries Chat Service for MUC Light Support via Disco</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;lx09df27&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span> <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#info&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p>The service MUST return its identity and the features it supports.</p>
<p><strong>Service Returns a Disco Info Result</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;lx09df27&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#info&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">category=</span><span class="s">&#39;conference&#39;</span> <span class="na">name=</span><span class="s">&#39;Shakespearean Chat Service&#39;</span> <span class="na">type=</span><span class="s">&#39;text&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;feature</span> <span class="na">var=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="33-discovering-occupied-rooms">3.3. Discovering Occupied Rooms</h3>
<p>The service discovery items ("disco#items") protocol enables an entity to query a service for a list of associated items, which in the case of a chat service would consist of the specific chat rooms the entity occupies.</p>
<p><strong>Entity Queries Chat Service for Rooms</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;zb8q41f4&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p>The service MUST return a full list of the rooms the entity occupies. The server SHOULD include room name and version in each item.</p>
<p><strong>Service Returns a Disco Items Result</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;zb8q41f4&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;heath@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;A Lonely Heath&#39;</span> <span class="na">version=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;A Dark Cave&#39;</span> <span class="na">version=</span><span class="s">&#39;2&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;forres@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;The Palace&#39;</span> <span class="na">version=</span><span class="s">&#39;3&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;inverness@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Macbeth&amp;apos;s Castle&#39;</span>
              <span class="na">version=</span><span class="s">&#39;4&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p>If the full list of rooms is large (see XEP-0030 for details), the service MAY return only a partial list of rooms. If it does, it MUST include a <code>&lt;set/&gt;</code> element qualified by the 'http://jabber.org/protocol/rsm' namespace (as defined in Result Set Management (XEP-0059) [1]) to indicate that the list is not the full result set.</p>
<p><strong>Service Returns a Limited List of Disco Items Result</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;hx51v49s&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;alls-well-that-ends-well@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Everybody dies&#39;</span>
              <span class="na">version=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;as-you-like-it@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;As you like it&#39;</span>
              <span class="na">version=</span><span class="s">&#39;2&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;cleopatra@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;Cleo fans&#39;</span> <span class="na">version=</span><span class="s">&#39;3&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;comedy-of-errors@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;404 Comedy not found&#39;</span>
              <span class="na">version=</span><span class="s">&#39;4&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;coriolanus@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;What is Coriolanus?&#39;</span>
              <span class="na">version=</span><span class="s">&#39;5&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;cymbeline@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;Music room&#39;</span> <span class="na">version=</span><span class="s">&#39;6&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;hamlet@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;To chat or not to chat?&#39;</span>
              <span class="na">version=</span><span class="s">&#39;7&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;henry-the-fourth-one@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Royal Room 1&#39;</span>
              <span class="na">version=</span><span class="s">&#39;8&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;henry-the-fourth-two@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Royal Room 2&#39;</span>
              <span class="na">version=</span><span class="s">&#39;9&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;henry-the-fifth@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Royal Room Prime&#39;</span>
              <span class="na">version=</span><span class="s">&#39;10&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;set</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/rsm&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;first</span> <span class="na">index=</span><span class="s">&#39;0&#39;</span><span class="nt">&gt;</span>alls-well-that-ends-well@muclight.shakespeare.lit<span class="nt">&lt;/first&gt;</span>
            <span class="nt">&lt;last&gt;</span>henry-the-fifth@muclight.shakespeare.lit<span class="nt">&lt;/last&gt;</span>
            <span class="nt">&lt;count&gt;</span>37<span class="nt">&lt;/count&gt;</span>
        <span class="nt">&lt;/set&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h2 id="4-occupant-use-cases">4. Occupant Use Cases</h2>
<h3 id="41-sending-a-message-to-a-room">4.1. Sending a message to a room</h3>
<p>Every occupant in the room MAY broadcast messages to other occupants. In order to do so, the client MUST send a groupchat message to the room bare JID.</p>
<p>The room automatically assumes that occupants' nicks are equal to their bare JIDs. MUC light is designed for applications where it is not important to hide behind nicknames. On the contrary - it is up to the client to replace pure JIDs with user-friendly names like phone numbers or full names if necessary.</p>
<p>The room MUST route all messages of the 'groupchat' type.</p>
<p><strong>Client sends a message to the room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;msg111&#39;</span>
         <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Server broadcasts a groupchat message</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">id=</span><span class="s">&#39;msg111&#39;</span> <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">id=</span><span class="s">&#39;msg111&#39;</span> <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone2@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p>Note the message is sent to all the room occupants including the original sender.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">id=</span><span class="s">&#39;msg111&#39;</span> <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="42-changing-a-room-subject">4.2. Changing a room subject</h3>
<p>The service MAY allow room occupants to set the room subject by changing the "subject" configuration field. A standard configuration stanza is used in this case. Subject change is announced like an ordinary configuration change.</p>
<p><strong>Client sends a message to the room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;subject1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;newsubject&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>asdfghj000<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>asdfghj<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;newsubject&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>asdfghj000<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>asdfghj<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;subject1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="43-requesting-room-information">4.3. Requesting room information</h3>
<p>Room occupants may request room information (configuration and/or occupants list) by an information version. It is up to the service to define the version string, the only requirement for it, is to be unique per room. Please note there are no separate versions for configuration and occupant list alone.</p>
<p>If the server side version does not match the one provided by the client (or if the client does not provide one, i.e. the 'version' element is empty), the service MUST respond with a current version string and full configuration and/or occupant list.</p>
<p>If the version strings match, server MUST reply with an empty result.</p>
<p>Only room occupants can get room information.</p>
<p><strong>Matching versions</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;config0&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>abcdefg<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;config0&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="431-getting-the-room-configuration">4.3.1. Getting the room configuration</h4>
<p><strong>Client gets configuration from the server</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getconfig1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>abcdefg<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getconfig1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>123456<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;roomname&gt;</span>A Dark Cave<span class="nt">&lt;/roomname&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="432-requesting-a-user-list">4.3.2. Requesting a user list</h4>
<p><strong>Client requests a user list</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getmembers&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>abcdefg<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getmembers&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>123456<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>user1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user2@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user3@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="433-requesting-full-room-information">4.3.3. Requesting full room information</h4>
<p>Room occupants may request both lists (configuration + occupants) with a single request.</p>
<p><strong>Client requests room information</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getinfo1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#info&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>abcdefg<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getinfo1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#info&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>123456<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
            <span class="nt">&lt;roomname&gt;</span>A Dark Cave<span class="nt">&lt;/roomname&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;occupants&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>user1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user2@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user3@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;/occupants&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="44-leaving-the-room">4.4. Leaving the room</h3>
<p>Every occupant is allowed to leave the room at any time. It is done by modifying their own affiliation.</p>
<p><strong>Occupant leaves the room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;leave1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;leave1&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag77@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;leave1&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>1111111<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag88@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;leave1&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>1111111<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;leave1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="45-blocking-functionality">4.5. Blocking functionality</h3>
<p>A user MAY choose to automatically deny being added to the room. All stanzas must be directed to MUC Light service. User MAY send more than one item in a single request and mix both 'user' and 'room' elements.</p>
<p>If the occupant tries to add another user to the room, and this user has set a blocking policy, the server MUST ignore the attempt. No error is returned, this user is simply skipped when processing affiliation change query.</p>
<p><strong>Service denies adding blocking user</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone2@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;blocked1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone3@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone2@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;blockedadd1&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone3@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag88@@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;blockedadd1&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone3@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone2@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;blocked1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="451-requesting-a-blocking-list">4.5.1. Requesting a blocking list</h4>
<p>In order to get the current blocking list in the MUC Light service, the client sends an empty IQ get query with a proper namespace.</p>
<p>The list includes only items with a 'deny' action, since the 'allow' behaviour is default for MUC Light and is only used for the list modification.</p>
<p><strong>User retrieves a blocking list</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getblock1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#blocking&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span>
    <span class="na">id=</span><span class="s">&#39;getblock1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#blocking&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;room</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>coven@muclight.shakespeare.lit<span class="nt">&lt;/room&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="452-blocking-a-room">4.5.2. Blocking a room</h4>
<p>In order to block a room, a query must contain at least one 'room' item with a 'deny' action and a room bare JID in the content.</p>
<p><strong>User blocks a room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;block1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#blocking&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;room</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>coven@muclight.shakespeare.lit<span class="nt">&lt;/room&gt;</span>
        <span class="nt">&lt;room</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>chapel@shakespeare.lit<span class="nt">&lt;/room&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span>
    <span class="na">id=</span><span class="s">&#39;block1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="453-blocking-a-user">4.5.3. Blocking a user</h4>
<p>In order to block a user, a query must contain at least one 'user' item with a 'deny' action and a user bare JID in the content.</p>
<p><strong>User blocks another user</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;block2&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#blocking&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">action=</span><span class="s">&#39;deny&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span>
    <span class="na">id=</span><span class="s">&#39;block2&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="454-unblocking">4.5.4. Unblocking</h4>
<p>In order to cancel a blocking, a query must contain at least one 'room' or 'user' item with an 'allow' action and an appriopriate bare JID in the content.</p>
<p>Unblocking a JID that is not blocked does not trigger any error. The server MUST return an empty IQ result in such case.</p>
<p><strong>User cancels blocking</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;unblock1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#blocking&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;room</span> <span class="na">action=</span><span class="s">&#39;allow&#39;</span><span class="nt">&gt;</span>coven@muclight.shakespeare.lit<span class="nt">&lt;/room&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">action=</span><span class="s">&#39;allow&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span>
    <span class="na">id=</span><span class="s">&#39;unblock1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h2 id="5-owner-use-cases">5. Owner Use Cases</h2>
<h3 id="51-creating-a-new-room">5.1. Creating a new room</h3>
<p>A room is created by submitting a dedicated stanza. The client application should pick a random room node name, since a human-readable room name is in configuration.</p>
<p>For rules that apply to the configuration options, please see "Setting room configuration" chapter.</p>
<p>The client MAY include initial configuration and occupant list (the list MUST NOT include the creator). The server MAY allow sending an incomplete configuration form. In such case the server MUST use the default values for missing fields. The server MAY enforce a minimal occupant list length.</p>
<p>The service MAY either give the creator the 'owner' or 'member' status. In the latter case all users are equal.</p>
<p>Upon room creation success, the service MUST reply with an empty IQ result.</p>
<p>The following rules (similar to the ones relevant to the affiliation change request) apply to the occupant list:</p>
<ul>
<li>'none' affiliation cannot be used.</li>
<li>All user bare JIDs must be unique</li>
<li>At most one owner can be chosen. If none is chosen, the room creator will become "just" a 'member'.</li>
</ul>
<p>After the room is created (but before receiving IQ result), new occupants (including the creator) receive <code>&lt;message/&gt;</code> from the room with their affiliations (the stanza MUST include only recipient's affiliation) and the initial room version. <code>&lt;prev-version/&gt;</code> element MUST NOT be included.</p>
<p><strong>Client requests room creation</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;create1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#create&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
            <span class="nt">&lt;roomname&gt;</span>A Dark Cave<span class="nt">&lt;/roomname&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;occupants&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
            <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user2@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;/occupants&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;createnotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;user1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;createnotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;user2@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;createnotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user2@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;create1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="511-requesting-a-new-room-with-a-unique-name">5.1.1. Requesting a new room with a unique name</h4>
<p>If a client would like to avoid a room JID conflict, it MAY request creating a new room with a server-side generated name, that is verfied to be unique. In order to do so, the client MUST send a creation request to service JID, not room bare JID. The IQ result will originate from the new room bare JID</p>
<p>The messages with affiliation change notifications MUST have the same ID as IQ set and result.</p>
<p><strong>Client requests room creation</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;createrandom&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#create&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
            <span class="nt">&lt;roomname&gt;</span>Random Cave<span class="nt">&lt;/roomname&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;randomcave@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;createrandom&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>aaaaaaa<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;createrandom&#39;</span>
    <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="512-room-already-exists">5.1.2. Room already exists</h4>
<p>If the chosen room name already exists, the service MUST return a 'conflict' error.</p>
<p><strong>Client requests room creation with existing name</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;conflict1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;castle@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#create&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
            <span class="nt">&lt;roomname&gt;</span>A Dark Cave<span class="nt">&lt;/roomname&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;conflict1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;castle@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;cancel&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;conflict</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="52-destroying-a-room">5.2. Destroying a room</h3>
<p>A room is automatically destroyed when its occupant list becomes empty or the room owner explicitly sends an IQ with a room destroy request.</p>
<p>Before sending an IQ result, every occupant is notified that its affiliation has changed to 'none'. These notifications include an <code>&lt;x/&gt;</code> element qualified with a "urn:xmpp:muclight:0#destroy" namespace.</p>
<p>Only the room owner is allowed to destroy it.</p>
<p>Room destruction notification SHOULD NOT contain version (or "prev-version" information).</p>
<p><strong>Client requests room destruction</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;destroy1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#destroy&#39;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;destroynotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#destroy&#39;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag77@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;destroynotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#destroy&#39;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag88@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;destroynotif&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag88@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#destroy&#39;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;create1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="53-setting-room-configuration">5.3. Setting room configuration</h3>
<p>Only room owners can modify the room configuration but the service MAY allow members to change it too.</p>
<p>All room occupants MUST be notified about a configuration change and both the new and old room version string (<code>&lt;version /&gt;</code> and <code>&lt;prev-version /&gt;</code> respectively).</p>
<p>"version" and "prev-version" configuration field names are NOT ALLOWED - they are reserved for room versioning.</p>
<p>The service MAY allow the client to set the configuration fields with any name but it is NOT RECOMMENDED.</p>
<p>The Data Forms are not used for the configuration. Instead, the config fields are encoded in XML elements with names equal to the key and content equal to the value.</p>
<p><strong>Client configuration request to the server</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;conf2&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;roomname&gt;</span>A Darker Cave<span class="nt">&lt;/roomname&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;configchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>zaqwsx<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>zxcvbnm<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;roomname&gt;</span>A Darker Cave<span class="nt">&lt;/roomname&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;configchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#configuration&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>zaqwsx<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>zxcvbnm<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;roomname&gt;</span>A Darker Cave<span class="nt">&lt;/roomname&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;conf2&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<p>The server SHOULD accept incomplete (i.e. delta) configuration forms. In such case, values of the missing fields SHOULD be preserved.</p>
<h3 id="54-changing-the-occupant-list">5.4. Changing the occupant list</h3>
<p>The occupant list is modified by a direct affiliation change. Following rules apply:</p>
<ol>
<li>There are only 3 affiliations.<ul>
<li>owner - can do everything in the room</li>
<li>member - can send messages to the room and if the service allows it, can also change configuration or change others' affiliations</li>
<li>none - not in the room; it's a keyword for marking a user for removal from a room</li>
</ul>
</li>
<li>Every occupant can change its own affiliation to none in order to leave the room.</li>
<li>The only way to join the room is being added by other occupant.</li>
<li>The owner can change affiliations at will.</li>
<li>If the owner leaves, the server MAY use any strategy to choose a new one.</li>
<li>The room can have at most one owner. Giving someone else the 'owner' status effectively causes the current one to lose it.</li>
<li>The owner can choose a new owner when leaving by including both 'none' and 'owner' items in affiliation change request.</li>
<li>Every user JID can be used in the request at most once.</li>
<li>A single request MAY change multiple affiliations.</li>
<li>All changes must be meaningful, e.g. setting member's affiliation to 'member' is considered a bad request.</li>
<li>Server MAY allow members to add new members but they still cannot make anyone an 'owner' or remove other users from the room.</li>
<li>On success the server will reply with a result IQ with all the changed items. BEFORE returning the IQ result, the service MUST route a message with the affiliation change to all relevant users.</li>
</ol>
<p>Newcomers, i.e. users that were not occupants before the change, SHOULD receive only their own affiliation and SHOULD NOT receive a <code>&lt;prev-version /&gt;</code> element.</p>
<p>The notifications must include both the new and old room version (<code>&lt;version /&gt;</code> and <code>&lt;prev-version /&gt;</code> respectively) string (except for the ones directed to users that have been removed from the room).</p>
<p>The notifications contain a list of items. The item list may be different from the list in the IQ set, because some of the changes may require additional operations, e.g. choosing new owner when the old one leaves. Users, that are still in the room after the change, will receive the full change list. Users, that have been removed from the room with the request, will get only one item: themselves with affiliation 'none'.</p>
<p><strong>Affiliations change request</strong></p>
<p>Let's consider a room <code>coven</code> with following members:</p>
<ul>
<li><code>crone1</code> - <code>owner</code></li>
<li><code>hag77</code> - <code>member</code></li>
<li><code>hag88</code> - <code>member</code></li>
</ul>
<p><code>hag66</code> is not in the room yet.</p>
<p>User <code>crone1</code> wants to add <code>hag66</code> to the room, kick <code>hag88</code> out and make <code>hag77</code> the room owner.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;member1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag88@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p>Now each user will receive an update.
As you can see, affiliations have changed accordingly to <code>crone1</code> request.
However, this request implies one more update.
Since <code>hag77</code> has been promoted to a new owner, <code>crone1</code> is automatically degraded to <code>member</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;memberchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>njiokm<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>qwerty<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag88@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p>Because <code>hag66</code> was not a member of this room before, they only receive <strong>their own affiliation</strong> and <strong>no prev-version</strong> element.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;memberchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;version&gt;</span>qwerty<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p><code>hag77</code> receives an ordinary update, just like <code>crone1</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag77@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;memberchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;prev-version&gt;</span>njiokm<span class="nt">&lt;/prev-version&gt;</span>
        <span class="nt">&lt;version&gt;</span>qwerty<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>crone1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>hag77@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag88@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p><code>hag88</code> has been kicked out of the room and therefore gets only their own affiliation change of type 'none'.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag88@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;memberchange&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span><span class="nt">&gt;</span>hag88@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;body&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<p><code>crone1</code> gets the result IQ after the change.
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;member1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table></p>
<h2 id="6-interactions-with-rfcs-and-other-xeps">6. Interactions with RFCs and other XEPs</h2>
<h3 id="61-user-rosters">6.1. User rosters</h3>
<p>The service MAY add user's rooms to its roster. It allows the client to skip the separate Disco request to the service.
Roster items with rooms MUST belong to the group "urn:xmpp:muclight:0" (MUC Light namespace) and include the <code>&lt;version/&gt;</code> element.
Their subscription type MUST be 'to'.</p>
<p><strong>Entity requests the roster and receives a reply that includes a room item</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;get&#39;</span> <span class="na">id=</span><span class="s">&#39;roster1&#39;</span> <span class="na">to=</span><span class="s">&#39;shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:roster&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">id=</span><span class="s">&#39;roster1&#39;</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/tablet&#39;</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:roster&#39;</span> <span class="na">ver=</span><span class="s">&#39;ver7&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;hag77@shakespeare.lit&#39;</span> <span class="na">subscription=</span><span class="s">&#39;both&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;hag88@shakespeare.lit&#39;</span> <span class="na">subscription=</span><span class="s">&#39;both&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span> <span class="na">name=</span><span class="s">&#39;The Coven&#39;</span> <span class="na">subscription=</span><span class="s">&#39;to&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;group&gt;</span>urn:xmpp:muclight:0<span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;version&gt;</span>1234345<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="62-xep-0313-message-archive-management">6.2. XEP-0313 Message Archive Management</h3>
<p>This section defines the rules for archiving MUC Light events and messages.
Stanzas described in the subsections below MUST be archived by the server.
The stanzas not included here MUST NOT be archived.</p>
<p>The <code>&lt;message/&gt;</code> element inside <code>&lt;forwarded/&gt;</code> MUST include a "from" attribute and MUST NOT include a "to" attribute.
"id" SHOULD be archived as well.</p>
<p>In case of regular groupchat messages,
the "from" attribute MUST consist of a room full JID with a sender bare JID in the resource part.
As for room notification, e.g. create event, "from" MUST be equal to room bare JID.</p>
<p>Examples below use MAM v0.4 protocol.
The archive can be fetched only from a specific room, the client MUST NOT query MUC Light service directly.</p>
<h4 id="621-groupchat-message-from-occupant">6.2.1. Groupchat message from occupant</h4>
<p>Message from a user MUST be archived with all child elements.</p>
<p><strong>Occupant queries MAM and receives regular groupchat message</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;set&#39;</span> <span class="na">id=</span><span class="s">&#39;mamget1&#39;</span> <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:mam:1&#39;</span> <span class="na">queryid=</span><span class="s">&#39;f27&#39;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">id=</span><span class="s">&#39;aeb213&#39;</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:mam:1&#39;</span> <span class="na">queryid=</span><span class="s">&#39;f27&#39;</span> <span class="na">id=</span><span class="s">&#39;28482-98726-73623&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;forwarded</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:forward:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;delay</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:delay&#39;</span> <span class="na">stamp=</span><span class="s">&#39;2010-07-10T23:08:25Z&#39;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&quot;coven@muclight.shakespeare.lit/hag77@shakespeare.lit&quot;</span>
                     <span class="na">id=</span><span class="s">&quot;msgid11&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;body&gt;</span>Welcome!<span class="nt">&lt;/body&gt;</span>
                <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&quot;elixir:ingredient&quot;</span><span class="nt">&gt;</span>bat-wing<span class="nt">&lt;/x&gt;</span>
            <span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/forwarded&gt;</span>
    <span class="nt">&lt;/result&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;mamget1&#39;</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="622-affiliation-change">6.2.2. Affiliation change</h4>
<p>Every archived affiliation change notification MUST include the <code>&lt;version/&gt;</code> element and MUST NOT contain the <code>&lt;prev-version/&gt;</code> element.</p>
<p><strong>Occupant queries MAM and receives an affiliation change notification</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;set&#39;</span> <span class="na">id=</span><span class="s">&#39;mamget2&#39;</span> <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:mam:1&#39;</span> <span class="na">queryid=</span><span class="s">&#39;f37&#39;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">id=</span><span class="s">&#39;aef2133&#39;</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:mam:1&#39;</span> <span class="na">queryid=</span><span class="s">&#39;f37&#39;</span> <span class="na">id=</span><span class="s">&#39;21482-98726-71623&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;forwarded</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:forward:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;delay</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:delay&#39;</span> <span class="na">stamp=</span><span class="s">&#39;2013-07-10T21:08:25Z&#39;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&quot;coven@muclight.shakespeare.lit&quot;</span> <span class="na">id=</span><span class="s">&quot;notifid11&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;version&gt;</span>b9uf13h98f13<span class="nt">&lt;/version&gt;</span>
                    <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
                    <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user1@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
                    <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>user2@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
                <span class="nt">&lt;/x&gt;</span>
            <span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/forwarded&gt;</span>
    <span class="nt">&lt;/result&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;mamget12&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="623-room-creation">6.2.3. Room creation</h4>
<p>Room creation is archived as an affiliation change that includes ALL initial occupants (including the room creator).</p>
<h2 id="7-general-error-cases">7. General Error Cases</h2>
<h3 id="71-client-sends-an-unauthorized-stanza-to-a-room">7.1. Client sends an unauthorized stanza to a room</h3>
<p>If a client sends a stanza to the room, that it does not occupy, the service MUST reply with the 'item-not-found' error.</p>
<p><strong>Unauthorized IQ</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;member1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;member1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;cancel&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item-not-found</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Unauthorized message</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;unauth2&#39;</span>
         <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;unauth2&#39;</span>
         <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;cancel&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item-not-found</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="72-client-sends-a-presence-stanza-to-the-service">7.2. Client sends a &lt;presence/&gt; stanza to the service</h3>
<p>The service MUST ignore all <code>&lt;presence/&gt;</code> stanzas sent by the client.</p>
<h3 id="73-client-sends-an-invalid-stanza-to-the-service">7.3. Client sends an invalid stanza to the service</h3>
<p>If service receives an invalid stanza it MUST reply with a 'bad-request' error.</p>
<p><strong>Invalid IQ</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;bad1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">role=</span><span class="s">&#39;participant&#39;</span><span class="nt">&gt;</span>hag66@shakespeare.lit<span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;bad1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;modify&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bad-request</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<p><strong>Invalid message</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;bad2&#39;</span>
         <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;chat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;body&gt;</span>Harpier cries: &#39;tis time, &#39;tis time.<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;bad2&#39;</span>
         <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;modify&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bad-request</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="74-request-sender-has-insufficient-privileges">7.4. Request sender has insufficient privileges</h3>
<p>If the request sender does not have sufficient privileges (but is a room occupant),
the service MUST reply with a 'not-allowed' error.</p>
<p>It occurs in the following cases:</p>
<ul>
<li>A member tries to change the configuration but the service is not configured to allow it.
  It does not apply to the subject change,
  although it has to be performed by sending <code>&lt;message/&gt;</code> with <code>&lt;subject/&gt;</code>,
  not configuration <code>&lt;iq/&gt;</code>.</li>
<li>A member tries to change anyone's affiliation to 'none' or 'owner'.</li>
<li>A member tries to change someone's affiliation to 'member' but the service is not configured to allow it.</li>
</ul>
<p><strong>Prohibited IQ</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;minion@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;privileges1&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;urn:xmpp:muclight:0#affiliations&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;user</span> <span class="na">role=</span><span class="s">&#39;owner&#39;</span><span class="nt">&gt;</span>minion@shakespeare.lit<span class="nt">&lt;/user&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;minion@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;privileges1&#39;</span>
    <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">type=</span><span class="s">&#39;cancel&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;not-allowed</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h2 id="8-implementation-notes">8. Implementation Notes</h2>
<h3 id="81-xep-0045-mappings">8.1. XEP-0045 mappings</h3>
<p>Some client-side developers might choose to use existing XEP-0045 Multi-User Chat implementations
to interface with the new MUC Light.
There may be various reasons to do so: using a familiar protocol,
avoiding additional implementation, quick prototyping etc.
This section provides suggestions of mappings between XEP-0045 stanzas and the new ones described in this document.</p>
<p>Operations not described here SHOULD remain unmodified.</p>
<h4 id="811-discovering-the-features-supported-by-a-muc-service">8.1.1. Discovering the Features Supported by a MUC Service</h4>
<p>A Disco result MAY either include a new <code>&lt;feature/&gt;</code> element with an "http://jabber.org/protocol/muc" namespace
next to MUC Light one, or completely replace it, which is the RECOMMENDED behaviour.</p>
<p><strong>Returning a MUC namespace in Disco</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">id=</span><span class="s">&#39;lx09df27&#39;</span>
    <span class="na">to=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#info&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;lx09df27&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#info&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;identity</span> <span class="na">category=</span><span class="s">&#39;conference&#39;</span>
                  <span class="na">name=</span><span class="s">&#39;Shakespearean Chat Service&#39;</span>
                  <span class="na">type=</span><span class="s">&#39;text&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;feature</span> <span class="na">var=</span><span class="s">&#39;http://jabber.org/protocol/muc&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="812-discovering-occupied-rooms">8.1.2. Discovering Occupied Rooms</h4>
<p>The room list MUST NOT include room versions.</p>
<p><strong>Service Returns Disco Items Result</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;zb8q41f4&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/disco#items&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;heath@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;A Lonely Heath&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;A Dark Cave&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;forres@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;The Palace&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">jid=</span><span class="s">&#39;inverness@muclight.shakespeare.lit&#39;</span>
              <span class="na">name=</span><span class="s">&#39;Macbeth&amp;apos;s Castle&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="813-changing-a-room-subject">8.1.3. Changing a room subject</h4>
<p>Instead of distributing the configuration change notifications,
the room MUST route <code>&lt;message/&gt;</code> with a <code>&lt;subject/&gt;</code> like a classic MUC would.
The client MUST send a classic message <code>&lt;subject/&gt;</code> as well.
The room SHOULD save a new subject in the room configuration.</p>
<p><strong>New subject is routed as an ordinary message</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
         <span class="na">id=</span><span class="s">&#39;compsubject&#39;</span>
         <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;compsubject&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span>
         <span class="na">id=</span><span class="s">&#39;compsubject&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;subject&gt;</span>To be or not to be?<span class="nt">&lt;/subject&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="814-getting-a-room-configuration">8.1.4. Getting a room configuration</h4>
<p>Room configuration is encoded in a Data Form, that simulates the XEP-0045 config form.</p>
<p>Getting the room configuration does not benefit from room versioning.</p>
<p><strong>Requesting room configuration</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-config&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#owner&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-config&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#owner&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:x:data&#39;</span> <span class="na">type=</span><span class="s">&#39;form&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;title&gt;</span>Configuration for &quot;coven&quot; Room<span class="nt">&lt;/title&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">type=</span><span class="s">&#39;hidden&#39;</span> <span class="na">var=</span><span class="s">&#39;FORM_TYPE&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>http://jabber.org/protocol/muc#roomconfig<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">label=</span><span class="s">&#39;Natural-Language Room Name&#39;</span>
                   <span class="na">type=</span><span class="s">&#39;text-single&#39;</span>
                   <span class="na">var=</span><span class="s">&#39;muc#roomconfig_roomname&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>A Dark Cave<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">label=</span><span class="s">&#39;Room subject&#39;</span>
                   <span class="na">type=</span><span class="s">&#39;text-single&#39;</span>
                   <span class="na">var=</span><span class="s">&#39;muc#roomconfig_subject&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>To be or not to be?<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="815-requesting-a-user-list">8.1.5. Requesting a user list</h4>
<p>A user list is retrieved with an affiliation IQ get.</p>
<p><strong>Requesting affiliation list</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-getaff&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span> <span class="na">type=</span><span class="s">&#39;get&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#admin&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-getaff&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#admin&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span>
              <span class="na">jid=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
              <span class="na">nick=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
              <span class="na">role=</span><span class="s">&#39;moderator&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span>
              <span class="na">jid=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
              <span class="na">nick=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
              <span class="na">role=</span><span class="s">&#39;participant&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="816-requesting-room-information">8.1.6. Requesting room information</h4>
<p>There is no XEP-0045 equivalent for getting full room information.</p>
<h4 id="817-leaving-the-room">8.1.7. Leaving the room</h4>
<p>Leaving the room is performed by setting the own affiliation to 'none'.
The service uses <code>&lt;presence/&gt;</code> to notify all occupants (and former occupant) about the change.
<code>&lt;presence/&gt;</code> to the leaving occupant MUST be of the type "unavailable"
and MUST include a status code 321 (i.e. user leaving due to affiliation change).</p>
<p><strong>Leaving the room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-leave&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#admin&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/crone1@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
          <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;crone1@shakespeare.lit/pda&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;321&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/crone1@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/desktop&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;crone1@shakespeare.lit/pda&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;321&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-leave&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="818-blocking-functionality">8.1.8. Blocking functionality</h4>
<p>The blocking functionality uses a small subset of the Privacy Lists protocol.
Stanzas MUST be addressed to the sender's bare JID (the <code>to</code> attribute may be skipped).
The privacy list name MUST be equal to "urn:xmpp:muclight:0".
Obviously, this method won't work properly in XMPP Server Federation, because privacy stanzas are handled by sender's server and the MUC Light Blocking functionality is handled by a MUC Light service server.
As opposed to XEP-0016, it is allowed to send "delta" privacy lists.</p>
<h5 id="8181-request-blocking-list">8.1.8.1. Request blocking list</h5>
<p><strong>Retrieving blocking list</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="na">type=</span><span class="s">&#39;get&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-getlist&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:privacy&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list</span> <span class="na">name=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-getlist&#39;</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:privacy&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list</span> <span class="na">name=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;deny&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;deny&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<h5 id="8182-blocking-a-room">8.1.8.2. Blocking a room</h5>
<p>In order to block a room, the client MUST deny a room bare JID in privacy list.</p>
<p><strong>Blocking a room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="na">type=</span><span class="s">&#39;set&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-blockroom&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:privacy&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list</span> <span class="na">name=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;deny&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-blockroom&#39;</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h5 id="8183-blocking-a-user">8.1.8.3. Blocking a user</h5>
<p>In order to block a room, the client MUST deny a service JID with user's bare JID in the resource.</p>
<p><strong>Blocking a user</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="na">type=</span><span class="s">&#39;set&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-blockuser&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:privacy&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list</span> <span class="na">name=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;deny&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-blockuser&#39;</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h5 id="8184-unblocking">8.1.8.4. Unblocking</h5>
<p><strong>Unblocking</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="na">type=</span><span class="s">&#39;get&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-getlist&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:iq:privacy&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list</span> <span class="na">name=</span><span class="s">&#39;urn:xmpp:muclight:0&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;allow&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;item</span> <span class="na">type=</span><span class="s">&#39;jid&#39;</span>
                  <span class="na">value=</span><span class="s">&#39;muclight.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
                  <span class="na">action=</span><span class="s">&#39;allow&#39;</span>
                  <span class="na">order=</span><span class="s">&#39;1&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">type=</span><span class="s">&#39;result&#39;</span> <span class="na">id=</span><span class="s">&#39;comp-getlist&#39;</span> <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="819-creating-a-room">8.1.9. Creating a room</h4>
<p>The room is created in a standard XEP-0045 way. Client MUST use a nick equal to their own bare JID.</p>
<p>Compatibility mode MUST NOT support a unique room name generation.</p>
<p><strong>Creating a room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
          <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit/crone1@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc&#39;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@chat.shakespeare.lit/crone1@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;owner&#39;</span> <span class="na">role=</span><span class="s">&#39;moderator&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;110&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;201&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<h5 id="8191-room-already-exists">8.1.9.1. Room already exists</h5>
<p>If the client attempts to create a room that is already used, it will
receive an error <code>&lt;presence/&gt;</code> informing that registration is required
(like in the case of members-only rooms in XEP-0045).</p>
<p><strong>Creating a room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit/crone1@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
          <span class="na">type=</span><span class="s">&#39;error&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;error</span> <span class="na">by=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span> <span class="na">type=</span><span class="s">&#39;auth&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;registration-required</span> <span class="na">xmlns=</span><span class="s">&#39;urn:ietf:params:xml:ns:xmpp-stanzas&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="8110-destroying-the-room">8.1.10. Destroying the room</h4>
<p>A classic XEP-0045 method is used but the service SHOULD NOT forward reason and alternate venue JID.</p>
<p><strong>Destroying the room</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;begone&#39;</span>
    <span class="na">to=</span><span class="s">&#39;heath@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#owner&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;destroy</span> <span class="na">jid=</span><span class="s">&#39;coven@muclight.shakespare.lit&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;reason&gt;</span>Some reason.<span class="nt">&lt;/reason&gt;</span>
        <span class="nt">&lt;/destroy&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;heath@chat.shakespeare.lit/crone1@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span> <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;destroy</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span>
    <span class="na">from=</span><span class="s">&#39;heath@chat.shakespeare.lit/wiccarocks@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;wiccarocks@shakespeare.lit/laptop&#39;</span> <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;destroy</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span>
    <span class="na">from=</span><span class="s">&#39;heath@chat.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
    <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit/pda&#39;</span>
    <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;destroy</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;heath@chat.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;begone&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="8111-setting-room-configuration">8.1.11. Setting room configuration</h4>
<p>Room occupants can use a standard XEP-0045 configuration modification method. The service MUST broadcast only the notification about the configuration change with a status code 104, so every occupant can retrieve the new room configuration in a separate request. The client is allowed to send a config delta in a form.</p>
<p><strong>Setting room configuration</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-setconfig&#39;</span>
    <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#owner&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;jabber:x:data&#39;</span> <span class="na">type=</span><span class="s">&#39;form&#39;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">type=</span><span class="s">&#39;hidden&#39;</span> <span class="na">var=</span><span class="s">&#39;FORM_TYPE&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>http://jabber.org/protocol/muc#roomconfig<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">label=</span><span class="s">&#39;Natural-Language Room Name&#39;</span>
                   <span class="na">type=</span><span class="s">&#39;text-single&#39;</span>
                   <span class="na">var=</span><span class="s">&#39;muc#roomconfig_roomname&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>A Darker Cave<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">label=</span><span class="s">&#39;Room subject&#39;</span>
                   <span class="na">type=</span><span class="s">&#39;text-single&#39;</span>
                   <span class="na">var=</span><span class="s">&#39;muc#roomconfig_subject&#39;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;value&gt;</span>To be!<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/x&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">id=</span><span class="s">&#39;comp-confchange&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;104&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">id=</span><span class="s">&#39;comp-confchange&#39;</span>
         <span class="na">to=</span><span class="s">&#39;crone2@shakespeare.lit/desktop&#39;</span>
         <span class="na">type=</span><span class="s">&#39;groupchat&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;104&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-setconfig&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h4 id="8112-changing-occupant-list">8.1.12. Changing occupant list</h4>
<p>The service MUST send an affiliation change notification to all participants.
Leaving users MUST NOT receive any information except for their own "none" affiliation.
New users MUST receive an invitation message.</p>
<p><strong>Changing occupant list</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-setaff&#39;</span>
    <span class="na">to=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">type=</span><span class="s">&#39;set&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;query</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#admin&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span> <span class="na">jid=</span><span class="s">&#39;hecate@shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/query&gt;</span>
<span class="nt">&lt;/iq&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@chat.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span>
          <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;321&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;message</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
         <span class="na">id=</span><span class="s">&#39;comp-invite0&#39;</span>
         <span class="na">to=</span><span class="s">&#39;hecate@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;invite</span> <span class="na">from=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/message&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@chat.shakespeare.lit/hag66@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span>
          <span class="na">type=</span><span class="s">&#39;unavailable&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;none&#39;</span> <span class="na">jid=</span><span class="s">&#39;hag66@shakespeare.lit&#39;</span> <span class="na">role=</span><span class="s">&#39;none&#39;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;status</span> <span class="na">code=</span><span class="s">&#39;321&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;presence</span> <span class="na">from=</span><span class="s">&#39;coven@chat.shakespeare.lit/hecate@shakespeare.lit&#39;</span>
          <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit&#39;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;x</span> <span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/muc#user&#39;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;item</span> <span class="na">affiliation=</span><span class="s">&#39;member&#39;</span>
              <span class="na">jid=</span><span class="s">&#39;hecate@shakespeare.lit&#39;</span>
              <span class="na">role=</span><span class="s">&#39;participant&#39;</span>
              <span class="na">nick=</span><span class="s">&#39;hecate@shakespeare.lit&#39;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;/presence&gt;</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nt">&lt;iq</span> <span class="na">from=</span><span class="s">&#39;coven@muclight.shakespeare.lit&#39;</span>
    <span class="na">id=</span><span class="s">&#39;comp-setaff&#39;</span>
    <span class="na">to=</span><span class="s">&#39;crone1@shakespeare.lit/desktop&#39;</span>
    <span class="na">type=</span><span class="s">&#39;result&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
</td></tr></table>
<h3 id="82-service-limits-and-configuration">8.2. Service limits and configuration</h3>
<p>The MUC Light service may be abused by a malicious users,
e.g. due to replicating a single message for every room occupant.
The list below contains suggested configurable limits that SHOULD be implemented.</p>
<p>The service features that might vary depending on a specific application are included as well.</p>
<ul>
<li>Maximum number of rooms the user occupies.</li>
<li>Blocking feature enabled/disabled.</li>
<li>XEP-0045 compatibility mode enabled/disabled.</li>
<li>Room creator's initial affiliation: owner/member.</li>
<li>Room configuration may be changed by owner/occupants.</li>
<li>New members can be invited by owner/occupants.</li>
<li>Maximal room size.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../authentication-methods/dummy/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Dummy
              </div>
            </div>
          </a>
        
        
          <a href="../token-reconnection/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Token-based reconnection
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/version-select.js"></script>
      
    
  </body>
</html>