
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MongooseIM is a mobile messaging platform with focus on performance and scalability">
      
      
        <meta name="author" content="Erlang Solutions">
      
      
        <link rel="canonical" href="https://esl.github.io/MongooseDocs/latest/latest/developers-guide/Hooks-and-handlers/">
      
      
        <link rel="prev" href="../logging/">
      
      
        <link rel="next" href="../hooks_description/">
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Hooks and Handlers - MongooseIM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hooks-handlers-and-accumulators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MongooseIM" class="md-header__button md-logo" aria-label="MongooseIM" data-md-component="logo">
      
  <img src="../../MongooseIM_logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MongooseIM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hooks and Handlers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/esl/MongooseIM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MongooseIM" class="md-nav__button md-logo" aria-label="MongooseIM" data-md-component="logo">
      
  <img src="../../MongooseIM_logo_white.png" alt="logo">

    </a>
    MongooseIM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/esl/MongooseIM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/Quick-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/Features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/Supported-standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported Standards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/High-level-Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-level Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/How-to-build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Build MongooseIM from source code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/Docker-build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to build and run MongooseIM docker image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/CETS-configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to configure MongooseIM to use CETS instead of Mnesia
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/push-notifications/Push-notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up Push Notifications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/push-notifications/Push-notifications-client-side/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up Push Notifications on the client side
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/push-notifications/MongoosePush-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up MongoosePush
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ICE_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up MongooseICE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/iOS_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Build an iOS messaging app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/Jingle-SIP-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up Jingle/SIP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/client-certificate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Set up SASL client certificate authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Open XMPP Extensions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Open XMPP Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-extensions/muc_light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MUC light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-extensions/inbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-extensions/smart-markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Smart Markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-extensions/token-reconnection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Token-based reconnection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-extensions/mam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MAM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/configuration-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/general/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Listen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/internal-databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Internal Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/outgoing-connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Outgoing connections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/Services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Extension Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/shaper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Shaper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/acl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Acl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/s2s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: S2S
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/host_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Options: Host config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/release-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/Erlang-cookie-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Erlang Cookie Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/TLS-hardening/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TLS Hardening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/database-backends-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Backends Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Authentication Methods
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Authentication Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/rdbms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDBMS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/external/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/anonymous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anonymous
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/jwt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/pki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PKI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication-methods/dummy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dummy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extension modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Extension modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_adhoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_adhoc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_amp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_amp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_auth_token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_auth_token
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_bind2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_bind2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_blocking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_blocking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_bosh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_bosh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_caps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_caps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_cache_users/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_cache_users
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_carboncopy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_carboncopy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_csi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_csi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_disco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_disco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_domain_isolation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_domain_isolation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_13" >
        
          
          <label class="md-nav__link" for="__nav_8_13" id="__nav_8_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    mod_event_pusher
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_13">
            <span class="md-nav__icon md-icon"></span>
            mod_event_pusher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_event_pusher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_event_pusher
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_event_pusher_http/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_event_pusher_push/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Push backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_event_pusher_rabbit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RabbitMQ backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_event_pusher_sns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNS backend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_extdisco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_extdisco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_global_distrib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_global_distrib
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_http_upload/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_http_upload
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_inbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_inbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_jingle_sip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_jingle_sip
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_keystore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_keystore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_last/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_last
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_mam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_mam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_muc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_muc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_muc_log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_muc_log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_muc_light/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_muc_light
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_offline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_offline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_offline_stub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_offline_stub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_ping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_ping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_presence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_presence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_privacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_privacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_private/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_private
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_pubsub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_push_service_mongoosepush/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_push_service_mongoosepush
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_register
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_roster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_roster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_sasl2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_sasl2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_shared_roster_ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_shared_roster_ldap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_smart_markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_smart_markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_sic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_sic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_stream_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_stream_management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_time
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_vcard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_vcard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/mod_version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_version
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    REST API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            REST API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rest-api/Client-frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client/frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rest-api/Administration-backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Administration backend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GraphQL API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            GraphQL API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphql-api/User-GraphQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graphql-api/Admin-GraphQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operation and Maintenance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Operation and Maintenance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/gdpr-considerations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GDPR considerations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Cluster-management-considerations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster management considerations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Cluster-configuration-and-node-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster configuration and node management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Logging-%26-monitoring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging & monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Humio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging with Humio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Logging-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Rolling-upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rolling upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/Cluster-restart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster restart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/MongooseIM-metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/System-Metrics-Privacy-Policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Metrics Privacy Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/tls-distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distribution over TLS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-and-maintenance/known-issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Known issues
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer's Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Developer's Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../release_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release/Installation configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bootstrap-Scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Testing-MongooseIM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing MongooseIM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Hooks and Handlers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Hooks and Handlers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Running a hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running a hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-results-from-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Getting results from handlers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-accumulators" class="md-nav__link">
    <span class="md-ellipsis">
      Using accumulators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-in-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Error handling in hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidenote-code-yet-to-be-written" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Code yet to be written
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidenote-multiple-domains" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Multiple Domains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registering-hook-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Registering hook handlers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unregistering-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Unregistering handlers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unregistering handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sidenote-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Writing handlers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hooks-list-and-how-to-extract-it" class="md-nav__link">
    <span class="md-ellipsis">
      Hooks list and how to extract it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Creating your own hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating your own hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-creating-a-new-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Example of creating a new hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example of creating a new hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-the-hook-with-type-specification-to-mongoose_hooks" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add the hook with type specification to mongoose_hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-create-the-mod_hook_example-module" class="md-nav__link">
    <span class="md-ellipsis">
      2. Create the mod_hook_example module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hooks_description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hooks description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accumulators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accumulators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Stanza-routing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stanza routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domain_management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mod_amp_developers_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_amp development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mod_muc_light_developers_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mod_muc_light developers doc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SCRAM-serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCRAM serialization format
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xep_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xep-tool usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OpenSSL-and-FIPS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FIPS mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basic-iq-handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic IQ Handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mongoose_wpool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mongoose_wpool
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Migration Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Migration Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/3.1.1_3.2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1.1 to 3.2.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/3.3.0_3.4.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3.0 to 3.4.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/3.5.0_3.6.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5.0 to 3.6.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/3.6.0_3.7.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.6.0 to 3.7.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/3.7.0_4.0.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.7.0 to 4.0.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/4.0.0_4.0.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.0.0 to 4.0.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/4.0.1_4.1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.0.1 to 4.1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/4.1.0_4.2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1.0 to 4.2.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/4.2.0_5.0.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2.0 to 5.0.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/5.0.0_5.1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.0.0 to 5.1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/5.1.0_6.0.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1.0 to 6.0.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/6.0.0_6.1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.0.0 to 6.1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/6.1.0_6.2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1.0 to 6.2.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/6.2.0_x.x.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2.0 to 6.x.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/jid-from-mam-muc-script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MAM MUC migration helper
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributions to the Ecosystem
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../History/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongooseIM History
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Running a hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running a hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-results-from-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Getting results from handlers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-accumulators" class="md-nav__link">
    <span class="md-ellipsis">
      Using accumulators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-in-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Error handling in hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidenote-code-yet-to-be-written" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Code yet to be written
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidenote-multiple-domains" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Multiple Domains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registering-hook-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Registering hook handlers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unregistering-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Unregistering handlers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Unregistering handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sidenote-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenote: Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Writing handlers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hooks-list-and-how-to-extract-it" class="md-nav__link">
    <span class="md-ellipsis">
      Hooks list and how to extract it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-own-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Creating your own hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating your own hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-creating-a-new-hook" class="md-nav__link">
    <span class="md-ellipsis">
      Example of creating a new hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example of creating a new hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-add-the-hook-with-type-specification-to-mongoose_hooks" class="md-nav__link">
    <span class="md-ellipsis">
      1. Add the hook with type specification to mongoose_hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-create-the-mod_hook_example-module" class="md-nav__link">
    <span class="md-ellipsis">
      2. Create the mod_hook_example module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="hooks-handlers-and-accumulators">Hooks, handlers and accumulators</h1>
<p>The hooks and handlers mechanism is one of the core architectural features of MongooseIM.
It allows for loose coupling between components of the system by calling only those which are available and configured to be used at runtime.</p>
<p>It can be thought of as a simple eventing mechanism notifying about certain things happening in the server.
That results in an extensible system with pluggable extra functionality.</p>
<p>To focus our attention, we'll analyze <code>mod_offline</code> which is responsible for storing messages for delivery to users unavailable at the time of sending.
<code>mod_offline</code> is an implementation of <a href="http://xmpp.org/extensions/xep-0203.html">XEP-0203: Delayed Delivery</a>.</p>
<h2 id="running-a-hook">Running a hook</h2>
<h3 id="basic-usage">Basic usage</h3>
<p><code>ejabberd_sm</code> (ejabberd/MongooseIM session manager) is the module discovering whether the recipient of a message is available or not.
That's where storing the message for later delivery takes place.
It is possible, but not recommended, to save a message in an offline storage by calling <code>mod_offline</code> directly:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nn">mod_offline</span><span class="p">:</span><span class="nf">store_packet</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">From</span><span class="p">,</span><span class="w"> </span><span class="nv">To</span><span class="p">,</span><span class="w"> </span><span class="nv">Packet</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Note that in this example <code>ejabberd_sm</code> is coupled with <code>mod_offline</code>.
I.e. if <code>mod_offline</code> was not available, the code would simply crash; if it was misconfigured or turned off, the behaviour would be undefined.
To avoid that coupling and also to enable other (<a href="#sidenote-code-yet-to-be-written">possibly yet to be written</a>) code to carry out some action at this particular moment, <code>ejabberd_sm</code> calls instead:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nn">mongoose_hooks</span><span class="p">:</span><span class="nf">offline_message_hook</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">From</span><span class="p">,</span><span class="w"> </span><span class="nv">To</span><span class="p">,</span><span class="w"> </span><span class="nv">Packet</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p><code>mongoose_hooks</code> is a module which serves as an API for calling hooks in the server. All such modules are placed in <code>src/hooks</code>.</p>
<p>For every hook, there needs to be a function in this module written beforehand which accepts the correct arity of arguments and makes the call to actual low-level hooks mechanism.
This means that there is some degree of coupling still - but this time between the <code>ejabberd_sm</code> module and <code>mongoose_hooks</code>, and the latter is always available.</p>
<p>The extra level of indirection introduced by this call gives the flexibility to determine at runtime what code actually gets run at this point.
This depends on which handlers are registered to process the event.</p>
<p><code>offline_message_hook</code> is the name of the hook (in other words of the event that is being signalled);
<code>Acc</code> is the <a href="#using-accumulators">Accumulator, described later</a>;
<code>From</code>, <code>To</code> and <code>Packet</code> are the arguments passed to the handler, just as they would in case of the function being called directly.</p>
<div class="admonition note">
<p class="admonition-title">Why do we even need the <code>mongoose_hooks</code> module?</p>
<p>Why is there a module in which we have to define the hook invocation beforehand?
Could we not just use the low-level hooks mechanism directly and avoid this module altogether?</p>
<p>This was actually the case before this module was introduced, and hooks' names were just atoms provided as an argument to this low-level API.
However, we discovered it was causing problems and producing bugs, due to the lack of static code analysis.
Now we can have some guarantees thanks to Dialyzer, and each hook invocation has a correct number of arguments.
Thanks to this, writing handlers is easier - there is a single source of truth about how a hook is run.
Remember that a given hook can be invoked from many places in many modules.</p>
<p>With the new <code>mongoose_c2s</code> implementation we introduced a new hook API module, <code>mongoose_c2s_hooks</code>.
All such API modules are placed in the <code>src/hooks</code> directory.</p>
</div>
<h3 id="getting-results-from-handlers">Getting results from handlers</h3>
<p>Hook handlers are called by "folding".
This means that each handler on a list is passed a set of arguments, and an initial value that it then modifies, returns and hands over to the next handler in line.
This modified data that is processed by the series of handlers is called an accumulator - because it accumulates the results.</p>
<p>A simple example would look like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">NewAcc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_hooks</span><span class="p">:</span><span class="nf">a_certain_hook</span><span class="p">(</span><span class="nv">Accumulator</span><span class="p">,</span>
<span class="w">                                       </span><span class="nv">StateData</span><span class="nl">#state.user</span><span class="p">,</span>
<span class="w">                                       </span><span class="nv">StateData</span><span class="nl">#state.server</span><span class="p">).</span>
</code></pre></div></td></tr></table></div>
<p>The initial value of the accumulator being passed through the sequence of handlers is provided with additional arguments required by the hook, as defined in the <code>mongoose_hooks</code> module.</p>
<div class="admonition info">
<p class="admonition-title">Folds</p>
<p>If you haven't encountered the term <em>fold</em> before, think of it as <em>reduce</em> (like <code>Array.reduce</code>) in Ruby-speak, roughly equivalent to the Reduce step in MapReduce, sometimes called <em>accumulate</em>, <em>aggregate</em> or <em>compress</em>.
<a href="http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29">See Wikipedia for more.</a></p>
</div>
<h3 id="using-accumulators">Using accumulators</h3>
<p>MongooseIM uses a dedicated data structure to accumulate data related to stanza processing (see <a href="../accumulators/">"Accumulators"</a>).
It is instantiated with an incoming stanza, passed along throughout the processing chain, supplied to and returned from certain hook calls, and terminated when the stanza is leaving MongooseIM.
There are some hooks which don't use this data structure.</p>
<p>If a Mongoose accumulator is passed to a hook, handlers should store their return values in one of 3 ways:</p>
<ul>
<li>If it is a one-off value which doesn't need to be passed on along with the accumulator (can be overwritten any time), use <code>mongoose_acc:set(hook, result, Value, Acc)</code>.</li>
<li>If the value is to be passed on to be reused within the current processing context, use <code>mongoose_acc:set(Namespace, Key, Value, Acc)</code>.</li>
<li>If the value should be passed on to the recipient's session, pubsub node etc. use <code>mongoose_acc:set_permanent(Namespace, Key, Value, Acc)</code>.</li>
</ul>
<p>A real life example, then, with regard to <code>mod_offline</code> is the <code>resend_offline_messages_hook</code> run in <code>mod_presence</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">Acc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_hooks</span><span class="p">:</span><span class="nf">resend_offline_messages_hook</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">Jid</span><span class="p">),</span>
<span class="nv">Rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nb">get</span><span class="p">(</span><span class="n">offline</span><span class="p">,</span><span class="w"> </span><span class="n">messages</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nv">Acc1</span><span class="p">),</span>
</code></pre></div></td></tr></table></div>
<h3 id="error-handling-in-hooks">Error handling in hooks</h3>
<p>Hooks are meant to decouple modules; in other words, the caller signals that some event took place or that it intends to use a certain feature or a set of features, but how and if those features are implemented is beyond its interest.
For that reason hooks don't use the "let it crash" approach. Instead, it is rather like "fire-and-forget", more similar in principle to the <code>Pid ! signal</code> way.</p>
<p>In practical terms: if a handler throws an error, the hook machine logs a message and proceeds to the next handler with an unmodified accumulator.
If there are no handlers registered for a given hook, the call simply has no effect.</p>
<h3 id="sidenote-code-yet-to-be-written">Sidenote: Code yet to be written</h3>
<p>Let's imagine, that when building a <a href="http://en.wikipedia.org/wiki/Minimum_viable_product">minimum viable product</a> we settle on using <code>mod_offline</code> for delayed delivery of messages to unavailable clients.
However, while the product evolves (or the relevant client software catches up) we might drop <code>mod_offline</code> in favour of a more sophisticated solution like <a href="http://xmpp.org/extensions/xep-0313.html">Message Archive Management</a> which would require a different action to be taken at the same point.
Thanks to loose coupling and <code>mongoose_hooks</code>, it's possible to turn off <code>mod_offline</code> and turn on <code>mod_mam</code> without changing
a single line of code in <code>ejabberd_sm</code>.</p>
<p>The only required change is to the configuration (apart from deploying the new module) which can even be performed at runtime - without restarting the server.</p>
<h3 id="sidenote-multiple-domains">Sidenote: Multiple Domains</h3>
<p>A MongooseIM cluster may serve more than one domain at the same time.
E.g. it is quite common that services like Multi User Chat or Publish-Subscribe are available as subdomains of the main XMPP domain served by an installation.</p>
<p>Moreover, each XMPP host is of a certain type, as defined in <a href="../../configuration/general/#generalhost_types"><code>general.host_types</code></a>, and hooks can be called either globally (across all hosts/host types) or for one host type.
If you are not using <a href="../../user-guide/Features/#multi-tenancy-dynamic-domains">dynamic domains</a> or grouping hosts under host types, then each host has a corresponding host type implicitly, and the two terms are interchangeable.
Whether a hook is called globally or per host type is depends on its purpose.
It is decided when creating a hook and can be checked in the <code>mongoose_hooks</code> module for existing hooks.</p>
<h2 id="registering-hook-handlers">Registering hook handlers</h2>
<p>In order to store a packet when <code>ejabberd_sm</code> runs <code>offline_message_hook</code>, the relevant module must register a handler for this hook.
To attain the runtime configurability the module should register the handlers when it's loaded and unregister them when
it's unloaded.
That's usually done in, respectively, <code>start/2</code> and <code>stop/1</code> functions.
Here is the relevant snippet from <code>mod_offline:start/2</code>:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nn">gen_hook</span><span class="p">:</span><span class="nf">add_handlers</span><span class="p">(</span><span class="n">hooks</span><span class="p">(</span><span class="nv">HostType</span><span class="p">)),</span>
</code></pre></div></td></tr></table></div>
and the <code>hooks/1</code> function returns a list of tuples describing hook handlers, like:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span><span class="n">offline_message_hook</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="o">?</span><span class="nv">MODULE</span><span class="p">:</span><span class="n">inspect_packet</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">#{},</span><span class="w"> </span><span class="mi">50</span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>It is clearly visible that the handler <code>inspect_packet</code> is added to the <code>offline_message_hook</code>.</p>
<p><code>HostType</code> is the one for which the handler will be executed.
In the case of statically defined domains, it is the same as the host, as configured in the <a href="../../configuration/general/#generalhosts"><code>general.hosts</code> section</a>.</p>
<p>The handler itself is specified as a fun expression;
the arity of the function is always 3 - more about actual arguments in the <a href="#writing-handlers"><code>Writing handlers</code></a> section.
If the handler expects an incorrect number of arguments, it will simply crash.</p>
<p>The 4th element of this tuple is a map of static parameters that will be passed to every invocation of the handler.
It allows to specify additional handler config at the moment of its registering.</p>
<p>Multiple handlers may be registered for the same hook.
The last argument, 50, is the sequence number of this handler in the handler chain.
The higher the number, the later in the sequence the handler will be executed.
It's reasonable to keep this number small (e.g. in the range 0-100), though there's no real limit other than the size of the integer type in the Erlang VM.</p>
<h2 id="unregistering-handlers">Unregistering handlers</h2>
<p>Pluggability also requires the components to be unpluggable at will.
For that purpose there's the option to unregister a hook handler.
It's done in <code>mod_offline:stop/1</code> in a similar fashion to:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nn">gen_hook</span><span class="p">:</span><span class="nf">delete_handlers</span><span class="p">(</span><span class="n">hooks</span><span class="p">(</span><span class="nv">Host</span><span class="p">)),</span>
</code></pre></div></td></tr></table></div>
<p>The function <code>hooks/1</code> function returns a list of hook tuples exactly the same as passed to <code>gen_hook:add_handlers/1</code>.
Both these functions accept either a list of tuples.
There also exist functions <code>gen_hook:add_handler/5</code> and <code>gen_hook:delete_handler/5</code> which register and unregister one handler at a time.</p>
<h3 id="sidenote-metrics">Sidenote: Metrics</h3>
<p>Every time a hook is run, a corresponding metric of the same name in the same host is incremented by one.
There are some exceptions though as some metrics were implemented before the generic hook metrics.
List of hooks not updating generic metrics can be found in the <code>mongoose_metrics:filter_hook/1</code> function.
Such skipped hooks update metrics are defined in the <code>mongoose_metrics_hooks</code> module.</p>
<h2 id="writing-handlers">Writing handlers</h2>
<p>The signature of a handler has to follow these rules:</p>
<ul>
<li>Accepts correct arguments:<ul>
<li>Acc - accumulator which was passed from previous handler (or initial accumulator). May be <code>mongoose_acc</code> in particular</li>
<li>Params - map of hook parameters passed from <code>mongoose_hooks</code>. It is constant for every handler in one hook invocation.
For exact structure check the hook function in <code>mongoose_hooks</code> module, as different hooks use different parameters.</li>
<li>Extra - map of additional hook parameters. It is constant for <strong>every</strong> hook invocation.
It is created from the map described in <a href="#registering-hook-handlers"><code>Registering hook handlers</code></a> section with 3 additional parameters:
<code>host_type</code>, <code>hook_tag</code>, <code>hook_name</code>. Parameter <code>host_type</code> can be particularly useful.</li>
</ul>
</li>
<li>Returns a tuple <code>{ok | stop, Acc}</code> where <code>Acc</code> is the accumulator of the same type as the input one,
that shall be passed to the next handler (or return value in case of last handler).</li>
</ul>
<p>Let's look at this example, from MongooseIM codebase:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">in_subscription</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="p">#{</span><span class="n">to</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">ToJID</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">FromJID</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">Type</span><span class="p">},</span><span class="w"> </span><span class="p">_)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">process_subscription</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="nv">ToJID</span><span class="p">,</span><span class="w"> </span><span class="nv">FromJID</span><span class="p">,</span><span class="w"> </span><span class="nv">Type</span><span class="p">)</span><span class="w"> </span><span class="k">of</span>
<span class="w">        </span><span class="n">stop</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">};</span>
<span class="w">        </span><span class="p">{</span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="n">false</span><span class="p">}</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">false</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">)};</span>
<span class="w">        </span><span class="p">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">}</span>
<span class="w">    </span><span class="k">end</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<p>As seen in this example, a handler receives an accumulator, parameters and extra parameters (in this case - ignored).
Then it matches to the result of <code>process_subscription/4</code> and can return 3 different values:</p>
<ul>
<li><code>{ok, Acc}</code> - it allows further processing and does not change the accumulator.</li>
<li><code>{stop, mongoose_acc:set(hook, result, false, Acc)}</code> - it stops further processing and returns accumulator with a new value in it.</li>
<li><code>{stop, Acc}</code> - it stops further processing and does not change the accumulator.</li>
</ul>
<p>This is an important feature to note: in some cases our handler returns a tuple  <code>{stop, Acc}</code>.
This skips calling later actions in the handler sequence, while the hook call returns the <code>Acc</code>.
Further processing is only performed if the first element of return tuple is <code>ok</code>.</p>
<p>Watch out! Different handlers may be registered for the same hook - the priority mechanism orders their execution.
If a handler returns <code>{stop, Acc}</code> but runs early in the handler chain, it may prevent some other handler from running at all!
That might or might not be intentional.
It may be especially surprising in case of handlers from different modules registered for the same hook.
Always ensure what handlers are registered for a given hook (<code>grep</code> is your friend) and that you understand their interdependencies.</p>
<h2 id="hooks-list-and-how-to-extract-it">Hooks list and how to extract it</h2>
<p>The following command should give you a list of all the hooks available in MongooseIM:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>awk<span class="w"> </span><span class="s1">&#39;/\-export\(\[/,/\]\)\./&#39;</span><span class="w"> </span>src/hooks/*.erl<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-oh<span class="w"> </span><span class="s2">&quot;\w*/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/.$//&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort
</code></pre></div></td></tr></table></div>
It returns:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>adhoc_local_commands
adhoc_sm_commands
...
...
...
xmpp_stanza_dropped
</code></pre></div></td></tr></table></div></p>
<p>It just extracts the hooks exported from <code>mongoose_hooks</code> and other hook API modules.
Refer to <code>grep</code>/<code>ack</code> to find where they're used.</p>
<h2 id="creating-your-own-hooks">Creating your own hooks</h2>
<p>You should put the new hook inside <code>mongoose_hooks</code> with a correct type specification, which provides some security in places where the hooks are run.
This is the way all hooks are called in MongooseIM (see the examples in the <a href="../hooks_description/">hooks description</a>).
You could run <code>gen_hook:run_fold</code> directly, providing the hook name, but this is advised against.</p>
<p>Of course, as long as no module registers handlers for a hook, calling it won't have any effects.</p>
<p>This is similar to the case when a module registers handlers for some hook, but that hook is never run in the code.
That won't have an effect either.</p>
<h3 id="example-of-creating-a-new-hook">Example of creating a new hook</h3>
<p>The following is an example of a module which both runs and registers a few handlers for a completely new hook.
The handlers are run sequentially using disparate priorities and passing over an accumulator value.
One of the handlers stops the handler execution chain prematurely by returning <code>{stop, NewVal}</code>.
It's also possible to try out what happens when the same hook is run with different XMPP domains by passing an argument to <code>run_custom_hook/1</code> - we'll see that the handlers are registered for a particular domain only.</p>
<p>At the end, you can see a printout of an accumulator with some debugging info.</p>
<p>To cut the long story short:</p>
<h4 id="1-add-the-hook-with-type-specification-to-mongoose_hooks">1. Add the hook with type specification to <code>mongoose_hooks</code></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">-</span><span class="ni">spec</span><span class="w"> </span><span class="n">custom_new_hook</span><span class="p">(</span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">Number</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nv">Result</span><span class="w"> </span><span class="k">when</span>
<span class="w">    </span><span class="nv">HostType</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="nn">mongooseim</span><span class="p">:</span><span class="nf">host_type</span><span class="p">(),</span>
<span class="w">    </span><span class="nv">Acc</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">t</span><span class="p">(),</span>
<span class="w">    </span><span class="nv">Number</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span>
<span class="w">    </span><span class="nv">Result</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">t</span><span class="p">().</span>
<span class="nf">custom_new_hook</span><span class="p">(</span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">Number</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="nv">Params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">#{</span><span class="n">number</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Number</span><span class="p">},</span>
<span class="w">    </span><span class="n">run_hook_for_host_type</span><span class="p">(</span><span class="n">custom_new_hook</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="nv">Params</span><span class="p">).</span>
</code></pre></div></td></tr></table></div>
<p>Don't forget about exporting the function:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">custom_new_hook</span><span class="o">/</span><span class="mi">3</span><span class="p">]).</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="2-create-the-mod_hook_example-module">2. Create the <code>mod_hook_example</code> module</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">mod_hook_example</span><span class="p">).</span>

<span class="p">-</span><span class="ni">behaviour</span><span class="p">(</span><span class="n">gen_mod</span><span class="p">).</span>

<span class="p">-</span><span class="ni">include</span><span class="p">(</span><span class="s">&quot;mongoose.hrl&quot;</span><span class="p">).</span>

<span class="c">%% API</span>
<span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">run_custom_hook</span><span class="o">/</span><span class="mi">1</span><span class="p">]).</span>

<span class="c">%% gen_mod callbacks</span>
<span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">start</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="w">         </span><span class="n">stop</span><span class="o">/</span><span class="mi">1</span><span class="p">]).</span>

<span class="c">%% Hook handlers</span>
<span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">first_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
<span class="w">         </span><span class="n">stopping_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
<span class="w">         </span><span class="n">never_run_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">]).</span>

<span class="nf">start</span><span class="p">(</span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="nv">Opts</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="nn">gen_hook</span><span class="p">:</span><span class="nf">add_handlers</span><span class="p">(</span><span class="n">hooks</span><span class="p">(</span><span class="nv">HostType</span><span class="p">)).</span>

<span class="nf">stop</span><span class="p">(</span><span class="nv">HostType</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="nn">gen_hook</span><span class="p">:</span><span class="nf">delete_handlers</span><span class="p">(</span><span class="n">hooks</span><span class="p">(</span><span class="nv">HostType</span><span class="p">)).</span>

<span class="nf">hooks</span><span class="p">(</span><span class="nv">HostType</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="p">[{</span><span class="n">custom_new_hook</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="o">?</span><span class="nv">MODULE</span><span class="p">:</span><span class="n">first_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">#{</span><span class="n">extra_param</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="s">&quot;ExtraParam&quot;</span><span class="o">&gt;&gt;</span><span class="p">},</span><span class="w"> </span><span class="mi">25</span><span class="p">},</span>
<span class="w">     </span><span class="p">{</span><span class="n">custom_new_hook</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="o">?</span><span class="nv">MODULE</span><span class="p">:</span><span class="n">stopping_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">#{},</span><span class="w"> </span><span class="mi">50</span><span class="p">},</span>
<span class="w">     </span><span class="p">{</span><span class="n">custom_new_hook</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="o">?</span><span class="nv">MODULE</span><span class="p">:</span><span class="n">never_run_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">#{},</span><span class="w"> </span><span class="mi">75</span><span class="p">}].</span>

<span class="nf">run_custom_hook</span><span class="p">(</span><span class="nv">Host</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="nv">HostType</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_domain_api</span><span class="p">:</span><span class="nf">get_domain_host_type</span><span class="p">(</span><span class="nv">Host</span><span class="p">),</span>
<span class="w">    </span><span class="nv">Acc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">new</span><span class="p">(#{</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">?</span><span class="nv">LOCATION</span><span class="p">,</span><span class="w"> </span><span class="n">lserver</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Host</span><span class="p">,</span><span class="w"> </span><span class="n">host_type</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">HostType</span><span class="w"> </span><span class="p">}),</span>
<span class="w">    </span><span class="nv">Acc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">),</span>
<span class="w">    </span><span class="nv">ResultAcc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_hooks</span><span class="p">:</span><span class="nf">custom_new_hook</span><span class="p">(</span><span class="nv">HostType</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="nv">ResultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nb">get</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nv">ResultAcc</span><span class="p">),</span>
<span class="w">    </span><span class="o">?</span><span class="nv">LOG_INFO</span><span class="p">(#{</span><span class="n">what</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">hook_finished</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">ResultValue</span><span class="p">,</span><span class="w"> </span><span class="n">result_acc</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">ResultAcc</span><span class="p">}).</span>

<span class="nf">first_handler</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="p">#{</span><span class="n">number</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">Number</span><span class="p">},</span><span class="w"> </span><span class="p">#{</span><span class="n">extra_param</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">Extra</span><span class="p">})</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="nv">V0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nb">get</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">),</span>
<span class="w">    </span><span class="nv">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">V0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Number</span><span class="p">,</span>
<span class="w">    </span><span class="o">?</span><span class="nv">LOG_INFO</span><span class="p">(#{</span><span class="n">what</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">first_handler</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">V0</span><span class="p">,</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Number</span><span class="p">,</span>
<span class="w">                </span><span class="n">result</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Result</span><span class="p">,</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Extra</span><span class="p">}),</span>
<span class="w">    </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nv">Result</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">)}.</span>

<span class="nf">stopping_handler</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="p">#{</span><span class="n">number</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">Number</span><span class="p">},</span><span class="w"> </span><span class="p">_)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="nv">V0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nb">get</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">),</span>
<span class="w">    </span><span class="nv">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">V0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">Number</span><span class="p">,</span>
<span class="w">    </span><span class="o">?</span><span class="nv">LOG_INFO</span><span class="p">(#{</span><span class="n">what</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">stopping_handler</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">V0</span><span class="p">,</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Number</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nv">Result</span><span class="p">}),</span>
<span class="w">    </span><span class="p">{</span><span class="n">stop</span><span class="p">,</span><span class="w"> </span><span class="nn">mongoose_acc</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nv">Result</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="p">)}.</span>

<span class="nf">never_run_handler</span><span class="p">(</span><span class="nv">Acc</span><span class="p">,</span><span class="w"> </span><span class="p">#{</span><span class="n">number</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nv">Number</span><span class="p">},</span><span class="w"> </span><span class="p">_)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">    </span><span class="o">?</span><span class="nv">LOG_INFO</span><span class="p">(#{</span><span class="n">what</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">never_run_handler</span><span class="p">,</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="s">&quot;This handler won&#39;t run as it&#39;s registered with a priority bigger &quot;</span>
<span class="w">                          </span><span class="s">&quot;than that of stopping_handler/2 is. &quot;</span>
<span class="w">                          </span><span class="s">&quot;This text should never get printed.&quot;</span><span class="o">&gt;&gt;</span><span class="p">}),</span>
<span class="w">    </span><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="w"> </span><span class="nv">Acc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">Number</span><span class="p">}.</span>
</code></pre></div></td></tr></table></div>
<p>The module is intended to be used from the shell for educational purposes:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="n">mongooseim</span><span class="p">@</span><span class="n">localhost</span><span class="p">)</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nn">gen_mod</span><span class="p">:</span><span class="nf">is_loaded</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;localhost&quot;</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">mod_hook_example</span><span class="p">).</span>
<span class="nf">false</span>
<span class="p">(</span><span class="n">mongooseim</span><span class="p">@</span><span class="n">localhost</span><span class="p">)</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nn">mongoose_modules</span><span class="p">:</span><span class="nf">ensure_started</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;localhost&quot;</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">mod_hook_example</span><span class="p">,</span><span class="w"> </span><span class="p">#{}).</span>
<span class="p">{</span><span class="n">started</span><span class="p">,</span><span class="n">ok</span><span class="p">}</span>
<span class="p">(</span><span class="n">mongooseim</span><span class="p">@</span><span class="n">localhost</span><span class="p">)</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nn">gen_mod</span><span class="p">:</span><span class="nf">is_loaded</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;localhost&quot;</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">mod_hook_example</span><span class="p">).</span>
<span class="nf">true</span>
<span class="p">(</span><span class="n">mongooseim</span><span class="p">@</span><span class="n">localhost</span><span class="p">)</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nn">mongoose_logs</span><span class="p">:</span><span class="nf">set_module_loglevel</span><span class="p">(</span><span class="n">mod_hook_example</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="p">).</span>
<span class="nf">ok</span>
<span class="p">(</span><span class="n">mongooseim</span><span class="p">@</span><span class="n">localhost</span><span class="p">)</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nn">mod_hook_example</span><span class="p">:</span><span class="nf">run_custom_hook</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="s">&quot;localhost&quot;</span><span class="o">&gt;&gt;</span><span class="p">).</span>
<span class="k">when</span><span class="o">=</span><span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span><span class="nv">T12</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">16</span><span class="p">.</span><span class="mi">109544</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">level</span><span class="o">=</span><span class="n">info</span><span class="w"> </span><span class="n">what</span><span class="o">=</span><span class="n">first_handler</span><span class="w"> </span><span class="n">pid</span><span class="o">=&lt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">1081</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="nn">mod_hook_example</span><span class="p">:</span><span class="n">first_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span><span class="mi">41</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="mi">7</span><span class="w"> </span><span class="n">extra</span><span class="o">=</span><span class="nv">ExtraParam</span><span class="w"> </span><span class="n">argument</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span>
<span class="k">when</span><span class="o">=</span><span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span><span class="nv">T12</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">16</span><span class="p">.</span><span class="mi">109809</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">level</span><span class="o">=</span><span class="n">info</span><span class="w"> </span><span class="n">what</span><span class="o">=</span><span class="n">stopping_handler</span><span class="w"> </span><span class="n">pid</span><span class="o">=&lt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">1081</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="nn">mod_hook_example</span><span class="p">:</span><span class="n">stopping_handler</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span><span class="mi">48</span><span class="w"> </span><span class="n">value</span><span class="o">=</span><span class="mi">7</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="mi">9</span><span class="w"> </span><span class="n">argument</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span>
<span class="k">when</span><span class="o">=</span><span class="mi">2022</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">15</span><span class="nv">T12</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">16</span><span class="p">.</span><span class="mi">110028</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="n">level</span><span class="o">=</span><span class="n">info</span><span class="w"> </span><span class="n">what</span><span class="o">=</span><span class="n">hook_finished</span><span class="w"> </span><span class="n">pid</span><span class="o">=&lt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">1081</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">at</span><span class="o">=</span><span class="nn">mod_hook_example</span><span class="p">:</span><span class="n">run_custom_hook</span><span class="o">/</span><span class="mi">1</span><span class="p">:</span><span class="mi">36</span><span class="w"> </span><span class="n">result_acc_</span><span class="p">{</span><span class="n">example</span><span class="p">,</span><span class="n">value</span><span class="p">}</span><span class="o">=</span><span class="mi">9</span><span class="w"> </span><span class="n">result_acc_timestamp</span><span class="o">=</span><span class="mi">1671107836109517</span><span class="w"> </span><span class="n">result_acc_stanza</span><span class="o">=</span><span class="n">undefined</span><span class="w"> </span><span class="n">result_acc_ref</span><span class="o">=</span><span class="err">#</span><span class="nv">Ref</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">4046106046</span><span class="p">.</span><span class="mi">1908670465</span><span class="p">.</span><span class="mi">111816</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result_acc_origin_pid</span><span class="o">=&lt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">1081</span><span class="p">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result_acc_origin_location_mfa</span><span class="o">=</span><span class="p">{</span><span class="n">mod_hook_example</span><span class="p">,</span><span class="n">run_custom_hook</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="n">result_acc_origin_location_line</span><span class="o">=</span><span class="mi">32</span><span class="w"> </span><span class="n">result_acc_origin_location_file</span><span class="o">=/</span><span class="nv">Users</span><span class="o">/</span><span class="n">paweldlugosz</span><span class="o">/</span><span class="nv">Dev</span><span class="o">/</span><span class="nv">Repos</span><span class="o">/</span><span class="nv">MongooseIM</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">mod_hook_example</span><span class="p">.</span><span class="n">erl</span><span class="w"> </span><span class="n">result_acc_non_strippable</span><span class="o">=</span><span class="w"> </span><span class="n">result_acc_mongoose_acc</span><span class="o">=</span><span class="n">true</span><span class="w"> </span><span class="n">result_acc_lserver</span><span class="o">=</span><span class="n">localhost</span><span class="w"> </span><span class="n">result_acc_host_type</span><span class="o">=</span><span class="n">localhost</span><span class="w"> </span><span class="n">result</span><span class="o">=</span><span class="mi">9</span><span class="w"> </span>
<span class="n">ok</span>
</code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/mongooseim/mongooseim/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/esl/MongooseIM" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>